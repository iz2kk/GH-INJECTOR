#Region ;FUNCTION LIST IN FILE ORDER:

;===================================================================================================
; Function........:  CreateGUI()
;
; Description.....:  Creates the main GUI.
;
; Return Value(s).:  Handle to the created GUI.
;===================================================================================================
; Function........:	 UpdateTheme($bEnableDarkTheme = False)
;
; Description.....:  Toggles the GUI between light and dark theme.
;
; Parameter(s)....:  $bEnableDarkTheme	- If true dark theme will be enabled.
;										  If false light theme will be enabled.
;===================================================================================================
; Function........:	 GetStringDimensions($hWnd, $Text)
;
; Description.....:  Calculates the width/height of a string depending on the current font using
;						GetTextExtentPoint32.
;
; Parameters......:  $hWnd - Handle to the window which's font should be used
;					 $Text - The text to calculate.
;
; Return Value(s).:  A $tagSize structure. The X member is the width and the Y member the height
;						of the specified string.
;===================================================================================================
; Function........:  CreateGroupBoxNoText($x, $y, $w, $h, $BorderColour)
;
; Description.....:	 Creates a rectangular box. Similar to CreateGroupBox but without any text.
;
; Parameter(s)....:	 Check the documentation of CreateGroupBox.
;
; Return Value(s).:	 An array of control handles to the created labels:
;						$arr[0] = top label
;						$arr[1] = left label
;						$arr[2] = right label
;						$arr[3] = bottom label
;===================================================================================================
; Function........:  CreateGroupBox($hOwner, $Title, $x, $y, $w, $h, $BorderColour = 0xFF000000,
;								$TextStyle = $SS_CENTER, $TextColour = 0xFF000000, $TextOffset = 5)
;
; Description.....:  Creates a box with a title around a certain area. Similar to
;						GUICtrlCreateGroup with $SS_SUNKEN but without glitched backgroundcolour.
;						Uses the font of the GUI. Use GUISetFont before calling.
;
; Parameter(s)....:  $hOwner		- A handle to the main GUI window returned by GuiCreate.
;					 $Title			- A string which will be in the middle on the top of the group.
;					 $x				- Left side of the box.
;					 $y				- Top side of the box.
;					 $w				- Width of the box.
;					 $h				- Height of the box.
;					 $BorderColour	- Colour of the border.
;					 $TextColour	- Colour of the text (24 bit RGB).
;					 $TextStyle		- Either $SS_LEFT, $SS_CENTER or $SS_RIGHT. Other values
;										will be ignored.
;					 $TextOffset	- Offset of the text in px (left/right). Ignored
;										when $TextStyle is $SS_CENTER.
;
; Return Value(s).:   An array of control handles to the created labels:
;						$arr[0] = top left label
;						$arr[1] = top right label
;						$arr[2] = left label
;						$arr[3] = right label
;						$arr[4] = bottom label
;						$arr[5] = text label
;===================================================================================================
; Function........:  CreateBitmapFromIcon($BackgroundColour, $FilePath, $IconIndex, $Size)
;
; Description.....:  Creates a bitmap from an icon (eg. from the Shell32.dll) which can be used for
;						various things like popmenus or listviews.
;
; Parameter(s)....:  $BackgroundColour	- Backgroundcolour of the bitmap. Should be set to
;											_WinAPI_GetSysColor($COLOR_MENU) most of the times.
;					 $FilePath			- Path to the file containing the icon.
;					 $IconIndex			- Index of the icon within the file.
;					 $Size				- Width/Length of the bitmap. Can only be a square.
;
; Return Value(s).:  On Success - A handle to the bitmap.
;                    On Failure - 0.
;===================================================================================================
; Function........:  DllList_PopUp($hwnd)
;
; Description.....:  Creates and manages the popup menu (rightclick) in the dll list.
;
; Parameter(s)....:  $hwnd	- A handle to the parent control.
;===================================================================================================
; Function........:  UpdateLV($hListView, $ActionID, $Mode = $M_All, $Index = -1)
;
; Description.....:  Updates the items of the specified listview according to the ActionId and Mode.
;
; Parameter(s)....:  $hListView		- A handle to the listview control.
;					 $ActionID		- Identifier of the action to perform (check $A_ID_... values).
;					 $Mode			- Either all or selected indices.
;===================================================================================================
; Function........:  GUI_LV_SubclassProc($hWnd, $uMsg, $wParam, $lParam, $iID, $pData)
;
; Description.....:  A subclass procedure to catch VK_DELETE and VK_SPACE inputs to the listview.
;					 Also handles customdrawing when the GUI is set to dark mode.
;
; Parameter(s)....:  default SubClassProc arguments
;
; Return Value(s).:  By default calls are forwarded to DefSubclassProc using DllCall.
;					 	Exceptions (custom drawing when darkmode is enabled):
;							$uMsg = $WM_NOTIFY:
;								Code = $NM_CUSTOMDRAW and hWndFrom = handle to the listview header:
;									dwDrawStage = $CDDS_PREPAINT
;										Return $CDRF_NOTIFYITEMDRAW
;									dwDrawStage = $CDDS_ITEMPREPAINT
;										Return $CDRF_NOTIFYPOSTPAINT
;									dwDrawStage = $CDDS_ITEMPOSTPAINT
;										Return $CDRF_NEWFONT
;===================================================================================================
; Function........:  GUI_WM_NOTIFY($hWnd, $uMsg, $wParam, $lParam)
;
; Description.....:  WM_NOTIFY callback of the main GUI. Catches various messages
;						sent to the dll list (rightclick, doubleclick...)
;
; Parameter(s)....:  default wndProc arguments
;
; Return Value(s).:  Forwards calls to the internal AutoIt/Windows handler(s)
;						by returning $GUI_RUNDEFMSG.
;===================================================================================================
; Function........:  WM_CTLCOLORLISTBOX($hWnd, $uMsg, $wParam, $lParam)
;
; Description.....:  A WM_CTLCOLORLISTBOX callback to custom draw listboxes (comboboxes) when the
;						GUI is set to dark mode.
;
; Parameter(s)....:  default wndProc arguments
;
; Return Value(s).:  Forwards calls to the internal AutoIt/Windows handler(s)
;						by returning $GUI_RUNDEFMSG.
;===================================================================================================
; Function........:  WM_NOTIFY($hWnd, $uMsg, $wParam, $lParam)
;
; Description.....:  Main WM_NOTIFY callback. Forwards the call to the WM_NOTIFY proc of the
;						main GUI or the	ProcessList depending on the current state.
;
; Parameter(s)....:  default wndProc arguments
;
; Return Value(s).:  Forwards calls to WM_NOTIFY routines and returns their return values.
;===================================================================================================
; Function........:  WM_DROPFILES($hWnd, $uMsg, $wParam, $lParam)
;
; Description.....:  Handles dropped files to the dll list.
;
; Parameter(s)....:  default wndProc arguments
;
; Return Value(s).:  Forwards calls to the internal AutoIt/Windows handler(s)
;						by returning $GUI_RUNDEFMSG.
;===================================================================================================
; Function........:  WM_COMMAND($hwnd, $uMsg, $wParam, $lParam)
;
; Description.....:  Handles changes to the text input fields.
;
; Parameter(s)....:  default wndProc arguments
;
; Return Value(s).:  Forwards calls to the internal AutoIt/Windows handler(s)
;						by returning $GUI_RUNDEFMSG.
;===================================================================================================
; Function........:  WM_MOVE($hwnd, $uMsg, $wParam, $lParam)
;
; Description.....:  Handles changes to the GUI position.
;
; Parameter(s)....:  default wndProc arguments
;
; Return Value(s).:  Forwards calls to the internal AutoIt/Windows handler(s)
;						by returning $GUI_RUNDEFMSG.
;===================================================================================================
; Function........:  WM_PAINT($hwnd, $uMsg, $wParam, $lParam)
;
; Description.....:  Redraws process icon.
;
; Parameter(s)....:  default wndProc arguments
;
; Return Value(s).:  Forwards calls to the internal AutoIt/Windows handler(s)
;						by returning $GUI_RUNDEFMSG.
;===================================================================================================
; Function........:  ResetGUI()
;
; Description.....:  Resets the GUI settings according to the g_ variables.
;						This doesn't include the dll list.
;===================================================================================================
; Function........:  CloseGUI()
;
; Description.....:  Closes the GUI(s) and does some clean up.
;===================================================================================================
; Function........:  UpdateCursor()
;
; Description.....:  Handles cursor change, tooltip and clicks to the GH Banner.
;===================================================================================================
; Function........:  AddFile($Path, $UpdateLastDirectory = False)
;
; Description.....:  Adds a single file to the dll list after verifying that the file is a valid
;						PE file and isn't already in the list.
;
; Parameter(s)....:  $Path					- Absolute path to the file.
;					 $UpdateLastDirectory	- Updates the last directory if set to True.
;===================================================================================================
; Function........:  AddFiles($Path = 0)
;
; Description.....:  Opens a file dialog at the specified path or g_LastDirectory. Files selected
;						in the dialog will be added to the list (if valid).
;
; Parameter(s)....:  $Path - Path to the directory. If empty $g_LastDirectory will be used.
;===================================================================================================
; Function........:  UpdateProcessIcon($TargetPID)
;
; Description.....:  Updates the process icon and g_ExePath in the top left corner when
;						another process has been selected.
;
; Parameter(s)....:  $TargetPID - The process identifier of the new process.
;===================================================================================================
; Function........:  UpdateTargetProcess()
;
; Description.....:  Updates the global variables according to the current GUI settings (eg. after
; 						the ProcessList was used).
;===================================================================================================
; Function........:  CheckProcess()
;
; Description.....:  Quickly verifies whether the specified target process is still active.
;
; Return Value(s).:	 True 	- Process still exists.
;					 False	- Process doesn't exist.
;===================================================================================================
; Function........:  UpdateGUI()
;
; Description.....:  Main GUI function which handles all events and updates the GUI accordingly.
;
; Return Value(s).:  $GUI_RETURN 		- Default return value.
;                    $GUI_EXIT 			- User closed the GUI (mainloop in Main.au3 will stop).
;					 $GUI_INJECT		- Injection event.
;					 $GUI_UPDATE		- User wants to update the injector. This message is
;											returned if the user clicks the version label and the
;											current version is outdated.
;					 $GUI_RESET			- GUI gets reseted. This doesn't reset the dll list.
;					 $GUI_FORCE_UPDATE	- User wants to update/redownload the injector. Unlike
;											$GUI_UPDATE this is triggered by CTRL + left clicking
;											the update label which will trigger the update function
;											even if the current version is the newest.
;===================================================================================================

#EndRegion

#include "ProcessList.au3"
#include "Settings.au3"

#Region Global Definitions


$h_GUI 				= 0

$h_P_Banner 		= 0
$h_B_Close			= 0
$h_B_Minimize		= 0

;Settings
$h_B_Settings 			= 0

	$h_C_ProcName 		= 0
		$h_L_ProcName 	= 0
	$h_I_PID 			= 0
		$h_L_PID 		= 0
	$h_R_ProcName 		= 0
	$h_R_PID 			= 0
	$h_B_SelProcess		= 0
	$h_I_InjDelay 		= 0
		$h_L_InjDelay 	= 0
	$h_C_CloseAI 		= 0
	$h_C_AutoI 			= 0

	;;Injection method
	$h_B_InjectionMethod		= 0
		$h_C_Method				= 0
		$h_C_HijackHandle		= 0
			$h_L_HijackHandle 	= 0
		$h_C_LaunchMethod		= 0
		$h_C_CloakThread		= 0
			$h_L_CloakThread	= 0

	;;Cloaking
	$h_B_Cloaking				= 0
		$h_C_Header 			= 0
		$h_C_Unlink 			= 0
			$h_L_Unlink 		= 0
		$h_C_LoadCopy			= 0
		$h_B_AdvSettings		= 0
		$h_B_AdvSettingsB		= 0
			$h_G_AdvSettings			= 0
				$h_C_Shift				= 0
					$h_L_Shift			= 0
				$h_C_Clean				= 0
					$h_L_Clean			= 0
				$h_C_RandomizeName  	= 0


	$h_B_Reset 			= 0
	$h_B_SwitchTheme 	= 0

;Files
$h_B_Files		= 0
	$h_B_Add 	= 0
	$h_B_Inject = 0
	$h_B_Remove = 0

;Info
$h_B_Info			= 0
	$h_L_Version 		= 0
	$h_B_Help 			= 0
	$h_B_Changelog 		= 0
	$h_B_ToggleTips		= 0

$h_T_MenuBar		= 0
$h_T_TooltipCtrl 	= 0

$l_GUIWidth 	= 800
$l_GUIHeight	= 420
$l_BannerWidth 	= 727
$l_BannerHeight = 60
$l_DllListWidth = 2 * $l_GUIWidth / 3 - 25

$l_WindowTitle 	= "GH Injector V" & $g_CurrentVersion

$l_bBanner = Binary( _
		"0xFFD8FFE000104A46494600010101004800480000FFE108AC45786966000049492A000800000007000E01020012000000620000001A01050001000000740000001B010500010000007C000000280103000100000002000000310102000D000000840000003201020014000000920000006987040001000000A6000000D20000004372656174656420776974682047494D50004800000001000000480000000100000047494D5020322E31302E31320000323031393A30393A30372030323A34323A35370001008692070019000000B80000000000000000000000000000004372656174656420776974682047494D5000080000010400010000000001000001010400010000001500000002010300030000003801000003010300010000000600000006010300010000000600000015010300010000000300000001020400010000003E01000002020400010000006607000000000000080008000800FFD8FFE000104A46494600010100000100010000FFDB004300080606070605080707070909080A0C140D0C0B0B0C1912130F141D1A1F1E1D1A1C1C20242E2720222C231C1C2837292C30313434341F27393D38323C2E333432FFDB0043010909090C0B0C180D0D1832211C213232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232FFC00011080015010003012200021101031101FFC4001F0000010501010101010100000000000000000102030405060708090A0BFFC400B5100002010303020403050504040000017D01020300041105122131410613516107227114328191A1082342B1C11552D1F02433627282090A161718191A25262728292A3435363738393A434445464748494A535455565758595A636465666768696A737475767778797A838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE1E2E3E4E5E6E7E8E9EAF1F2F3F4F5F6F7F8F9FAFFC4001F0100030101010101010101010000000000000102030405060708090A0BFFC400B51100020102040403040705040400010277000102031104052131061241510761711322328108144291A1B1C109233352F0156272D10A162434E125F11718191A262728292A35363738393A434445464748494A535455565758595A636465666768696A737475767778797A82838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE2E3E4E5E6E7E8E9EAF2F3F4F5F6F7F8F9FAFFDA000C03010002110311003F00F2E44DED8C803A927B0A76F8D7811061EAC4E7F4A22048703A95E3F30698319E4903D85003982140C848E70549E6895424ACA3A038A5F2D4C6CC18FCBEA3AFB75A27FF005EFEE7340022068E563D55411F981FD69DB511DF2BB82A83827E94917FA99FFDD03FF1E14E7FBD2FFB8BFD2801BBA26382853DD4E714222A1937A86DA3239E3A8A8AAC13B4382A09118041FA8A008D9D0A90220A7D7269C4C68AA0C4189504924D465811808A3DC669D2F54FF705001B51D494C861C953CF1525DC2B0984267E7895CE7D48A8E1E1CB760A73F9568DD5DA44B6C86CEDE422DD3E670D9E9EC680295B42B2C572CD9CC716F5C7AEE51FD6A4D3A18A499A5B952D6D0AEF9403827B000FA92455886E926B4BE51696F11F241DD186CFDF5F52682B6B06991413492A4B31F39F6461BE5E883961EE7F114014AF2016D772421B72A9F95BFBCA7907F2C55968AD74F0AB7117DA2E48CB465CAA479E80E3927D7918E9524FE4CD656F71133C86D984729740A769395E3273DC67E82AB6A51BC7A8CFBF9DEE5D5BB329E411EC41A005926B29A26FF4536F281F29898B293EE1893F8E7F0A4BAB5D9710C502B3349146C14724B328271F89AA95BD35FDBDABC11790D996D2259A656C3A8D8BF73D3B67D7914019B71041690989DBCDBB27E6D8D948FDB3FC47F41EFDAD4565662E6649F788D6D6390383CAB304C9F71F31E2A8DDDA35AB29DC2489C6E8E551C38FF1F51DAB426FBF79FF005E307FE831500665C5BC96B318A4C647208390C0F420F706A78EC8CF0DA084132CD23AF278E31CFB7534FB665BE816CA5204ABFF001EF21FFD009F43DBD0FD6AE59A32C1040C364AE2E2250DC10E54003F1E9F8D005369AC2D98C715A8BAC706499D803F4552303EA4D3654B4B881E6B71E44A9CB42EF90C3D549FE46AA2A8120593728070D81923F0ABB15A5A4E93347713FEEA32E4B4200E3A0CEEEE703F1A00A71A06C963855EA6977C7D3C918F52C73FE1FA50BCDBB81D43027E9CFF009FC6A3A009022BBFCA48403249ED46F8C7022047AB139FD288F98A40073807F0A8E801EC80A6F4CEDCE083D8D3A48C2C48C3AE3E61E99E47E94880F96E7B1C28FAE73FD29E4EF9A44ECDC2FB63A7F850036DD15E5FDE7083A9F4ED51104120F51521F92151DD8EE3F4EDFD69261895BDFE6FCF9A0068254820E08E41A7F988DCB4633EAA719A28A006BB96E3015474029C240400E9BB1C020E0D14500233E46D550ABD71EB4A25F998B2860C304671FE7A5145002F9AABF723553EBC9229A926D2DB9770618393EF9A28A0019D0AE04601F5C9A779AA400D18240C67268A2801AF2161B42AAAFA2D3A69DA7285801B1020C7A0A28A00219CC2B2A850C245D8D9F4C83FD28B9B87BAB8799C0058F45180A3A003D80C0A28A00209CC02501430910A303E9C1FE601A9A2BE021105CC093C4A3E4C9DAC9F461FC8E45145000F791084C56D6A9106186773BDCFB64F03F002A1B89DAE1D" & _
		"1980056358C63D14003F95145003A2BB78ADE4B72AAF13F3B587DD6ECC3D0D39EF6473292ABFBC85213F450A01FAFCA28A2802B55BBAD424BB86DD1D543C39CC83ABE71C9F7E05145003DAFE1B819BBB45925EF2C6FB19BFDEE083F5C66A3B8BD32C5E44512416F907CB4C9DC4742C4F24F268A28021694799BE24118C01B412474C1EBEBD7F1A37C79C98867D371C7F9FC68A2801BE636FDE3823A60629DE6464E5A219F638068A28010CA4BA9C0C29C851D29A1886DC0F39CE68A2801D2BF99217DA173D874148CC5B19EC31451401FFD9FFE202B04943435F50524F46494C45000101000002A06C636D73043000006D6E74725247422058595A2007E3000900070000002A0010616373704D5346540000000000000000000000000000000000000000000000000000F6D6000100000000D32D6C636D7300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000D64657363000001200000004063707274000001600000003677747074000001980000001463686164000001AC0000002C7258595A000001D8000000146258595A000001EC000000146758595A00000200000000147254524300000214000000206754524300000214000000206254524300000214000000206368726D0000023400000024646D6E640000025800000024646D64640000027C000000246D6C756300000000000000010000000C656E5553000000240000001C00470049004D00500020006200750069006C0074002D0069006E002000730052004700426D6C756300000000000000010000000C656E55530000001A0000001C005000750062006C0069006300200044006F006D00610069006E000058595A20000000000000F6D6000100000000D32D736633320000000000010C42000005DEFFFFF325000007930000FD90FFFFFBA1FFFFFDA2000003DC0000C06E58595A200000000000006FA0000038F50000039058595A20000000000000249F00000F840000B6C458595A2000000000000062970000B787000018D9706172610000000000030000000266660000F2A700000D59000013D000000A5B6368726D00000000000300000000A3D70000547C00004CCD0000999A0000266700000F5C6D6C756300000000000000010000000C656E5553000000080000001C00470049004D00506D6C756300000000000000010000000C656E5553000000080000001C0073005200470042FFDB00430001010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101FFDB00430101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101FFC2001108003C02D703011100021101031101FFC4001D000002020301010100000000000000000000060507020304010809FFC40014010100000000000000000000000000000000FFDA000C03010002100310000001FCB3000180E721C0C8C4000C8F0F09333380D006D24800893B0EA394E200371A400E839C096224000CCB588F2B503A0D00074981A496224000DC693C1FC9F2A9340001E13C0409E8013A6042801B0D60006C3580012E498B4750C22C0C42A0000D8738B439102761222A0C44580118371086E24C87384B80A6400BCCA300FABCA40AFC0B047F29424CB6CF9F8B9CA580BFCAD47928F3EE63E362100EA2D72B02F92A6174BAC552AE02449F160F461160902585C360C2409C23E0A64781223488A0064340AA0004C128298000D86816463174006A358B2000328B400340BA5C0532005E6518340D2331441917E140800181761509F429429125DE51E5EE4A9F3B981D25B24F1F3F80016415B1E8DA2900000D8298000D42A8C8642C80CE602D8013E429A800006C14C0006C340B2318BA00319B8D00622F8CA2D001266C3EB22AC03D258F9C8BE8A10B74AFC6E1605C000303E952C23E2D3102EF28F2F82903E813E763A4B609228C000003A8912100009037910000318B832990AE0341AC5B3D0260E4388F49C024CD6298000D8681646317400643216400065168009A398B54A6400BCCA5CFAB8AC8F0642A53688A000607D667CC45F87CE005DE51E5F05103296214F96C92051A059A4F92E576229382F0001D24910800032108499164B9E90C4B90E6903C1C84E00331A08636112064339AC5918C5D0370C002C8000CA2D01E0DE2B97014C8017981491A40BCCA40FA14F9D4F40DA6A2E92963B4FA0CF9C8BB0A3CBE0A200B1CEB2409329E22C00FA14F9F0C46F13CF400C86E13C00F46C3945D3C19C058321845C003A86439CF4F457018CD80662B136410F4461E990AC311B0F4C45B1B8E53C3AC563C2CE2AC002DE3694E001D65942197411A66771F3F96B15481D45EA2D15217094F801769C25405EE626B3ACAAC8326C5C1A0D406E150D8341A0C8D82A1384080C402E813E4000001E01E8001E01E800000000000000000000000000000001881900000000000000001E1899800001E01E8001E01E80000000001FFC4002F100001040102030704020301000000000004010203050600101415200711133134353612222333162421254050FFDA0008010100010502DFCD5B5564E6CD5E70E9B222B97A15AE4D222AECD08D7B7979FA7C5245BB18F91DCBEC35CBEC35CBCFD2A2A2C43133A72FB0D48313174491C90BF77C52C69B0801A7F4B5AE7BA1C0F322223B0DCAEB22DA48A589777C3346C8E3925768900D099D1247242FDABB15C96DE39301" & _
		"CD2364B14B049D2CABB191B25658C4DE8655D8C8D96B8F85BBB58E7F4B98F674882F10AB63C3A39EF7AC0512339251ACB534320F2D1FBB7458FA5ADF3D5894444471A66A3B43E3D3503B2D3D8F89F4EAA8771A66B8D335C699B24D3434FC699A6589F1AA18297A28578AF8FF006F685F33DF2EF69DB1CB75C0E9328A76D1DDED8F63F35ECF3663052B4938D324AFBBB8A995B734995A4ADFA173CF7AD81A0ADA116F6FEC7212FB3CF9326AC0E02C68ECAB8CA93B683F77681F350C32AC0A79147856ACF22BDB99212CA1A41B3779F1E458E7296EC30D215229D085A92696574734D0B9A5C26ABDBF4B8415E53DC7462E9F24922C53CF0BB8A80E5247905975493A048540A311B0907124DD91C774222B96C5E9074905A930D17BBF458FA5ACF3D5A7ABDE7771A1547ADE877B3EE1BB89823FDBDA1FCD37CBFDA75495535DDB661690DA5E18BCFB0CD235CE5CBA7E4C2742F9679EF50413953361ACC0D0E38CB32F5D9E7C9B599FA00DCDCE2B5CD731DA87F77683F36AA93F8CE2BD14F7FC001B12EE103E9315051BA2354300D3FF001D497FD813617F004DFC953BD5A77D83DCAF7F4D17BBF458FA5ACF3D5A7ABDEBD7BD2993EA3F8066B806694162269DECFB84F58CD998911F9AD760F2653CAFB3CD72BECF35CAFB3CD67F18110BAC7FFD1635AC28F1C6B9B3AF22A6C70D8184E57704BCCB6E85F2C929ACAFB2810302AA95555576ECF3E4DACCFD0452CA3CB6B0C799566A1FDDDA0FCD736EF862EA859E24D64F57D874091A4A51EF590EE8A84FAAC3563F62577E76ED65F8755FF7B37AF91B11C4C4B011A4F3E204D71226A140C8828BDDBA2C7D2D679EAD3D5EE0FD90547ADE877B3EF5D1F8A73A4F14BED0BE67BE5FED30413153E49718B576B9D619A5B9C2D759BCA2E4216366B2B721C9EBDF5590742F967D9296C6046975C5121879C0FB7679F26D667E835516C651D8E495214E2C3FBBB41F9B656DE2E9F6ADB5C785139F623AAFB1C5EC4FCAA0AD172263958FB56234FE8864F066B28FC33BA2ABED2E28FC69ACE4F14F8A47432D9C6D695591B5C4C923A592B1FE19F233C39372112C46DDAD73DC5B9051839F862CE87872F644572DB2B526ACF3D5A7ABDA38DF2BCD7C704551EB7A1DECFBA356B858FF006F685F33DF2FF69C299182B248F9A4DB0C7A58A3D8E638C89733A2DD8C7CAF7A2B759E7BD6862480C89461F3E89CD735DD9E7C9B599FA0DB1ABF5A32AFA85298FED07E6D8B9225A579A1175A5EF8F4298BD5AAAB974DFF00621742A2A2FD3CC43DFBBBF53A72F16A53FBAABDEBA5FECD5FA6ABD23958B6CDEE3F786694791CB5C76B9490ED72C746BC5C0237661304F0F2B91FAE524B51B20B5FA55555065644BA28688A9397375C108CD3CE8618B554F8E33797375CB5BAE5CDD2FF00858591915BCB935C0449A692003A9247CAF62F7499B18358655BE4C7085D65C9E20D8E6E3913093E633D71D6D5F606D51929389653AFE036D269306206D7F20A3C6A27AABB5989831D6BB413CC34D686D4E5B5B841A2D7DFEB2A384302DF15B907C3CFDF0C99A687C8EAAE845C238BD37B3EBC4D31987636B7173617A70F136722E6BE1ABB363DD1B9D3867EB954CFD72B959A4243034AAAE58E47C2F74A01FAE533AEB9548CD212183A555551248E2836AB7B10BB4918E2F632464B0FFE77726BB93FE2EEEFD7727FD5FFC40014110100000000000000000000000000000090FFDA0008010301013F01363FFFC40014110100000000000000000000000000000090FFDA0008010201013F01363FFFC4005D1000020101050305070C0D060C0700000001020304000511122106133110202241511423324261718115243352627374759194B4B5343553727693A2B1B2B3C1D2D33654839296A1162540446382C2C4D1D4D5E25055648495A3F0FFDA0008010100063F02E5006A49C00EB24F0007593D960C28A700F0CEBBBC7D12143FDD6CD3524F1A7B7DDB18C79E45C507A5B942A82CC78050493E60353CD0482030C54904661C315ED18F58B1C01380C4E031C0638627B06240C7B48E40E94556E8C032B2534ECACA75055821041EA23436FB02B7E6951FC3B612C72444F01223464F9B301CA1234791CF04452EC7CCAA0936FB02BBE6951FC3B7D815DF34A8FE1DBEC0ADF9A547F0ED811811A107420F6116261A7A8980381314324801EC2514807C96FB02B7E6951FC3B632D3D4443B6486441F94A398D14D1C90CA87078A5468E443D8C8E0329F2103991B491491ACCBBC859E3745963C4AE788B00244CC0AE64C5730231C41E5A81454B3551A4A59AB6A77285F7149061BEA893DAC71E6198F979AA88ACEEE72A22296776F6AAAB8B31F2004D9664D9BBD1626C32BD442B461B1D461DD8F01FEEB77456ECF5EB0D38189A814AD3C0A3B5A6A6DF44A3CACC072E596392262AAE165468D8A38CC8E03804ABAF495B830D41239914B2432C714E0B412BC4E91CEAA72B342ECA165556E8B3465806D0EB611C51C92C84310912348E422191C854058848D59DCE1D1456638282792925ABA59A9E3AFA7EEBA29244212AA9B3B47BE81B83A091190E1AA918301A735A29A3922950E578E5468E446EC7470194F91803CBBEBB6E2BD2AE0FE7094922D31EBD2A6511C07D1259A43B37793A2785DCE91D595F3A524B3BFE4D9A19E2920990E0F14D1BC52A1EC78E40AEA7CE073B3AD15464F6CD198C1F36F3263E718DB3BD15464F6CB1991479CC79801E53A73732D15465ED74DD8FF00EDC98F9C5B3494750ABEDC465D3D2C99947A48E61C8ACF802C72A96C157566386382A8D49E0071E680E8C84A8701D4A92AC31561980C5586AADC186A39ACCEE21A687035150C" & _
		"3158C1F0540F1A590F46341C4F1C1713668AEC4EE58CF44D49C0D74C3DDCD877A53C447004CBA62CC46362CEECCC752CCC4927CA4DB3D3CF2C2DDB1BB2E23B187061DAAD883D62D92A562A4AE6F62AB8904705439F16B225E8248EDC2A21545C5BBE2603359E19972491B65653D47F683C411A11A8B517BE37EAA4E6DCDF17FF00BCCD6AFF008B2A7F594FC891C53CD1C6947778448E475551DC501D029038926DF65D4FE3E4FDEB65EEA9248CE8619CF7442C3B0C53674C0F5E98DB2848E82BCF8013A14152DED029C7B9656EAC0EE0FB8B347229474255D1860548EA22CA41C0882A88234208A7930208D7116FB2EA7F1F27EF5BECAA9FC7C9FBD6FB2AA7F1F27EF7245BA9648B35E3518EEDD931F5B5371CA47A2DF65D4FE3E4FDEB6295952BD646FA42A7EF9492ADE66045B2DE308490E3857D222C72E3FF00A9A75022A85ED28229B41D26D6C158AC91C8B9E19A338C73478E19D0FE707553A1B45EFB1FE9ADB683E1C7AB0F11399B05F8263EB6BCB96EFBCF76AF57B555FEBB8586AFB23485A9AA699B89C97A4B25475038409E7B5650C2FBDA2252AEEC9F8F745D958A2A286607139B181D558FDD15F9672668E82EBBBE2EE9BDEF6A8C7B9AEFA6C70C4E1ACB5131E85352A77C9E4D060A1983516C3D27A930E1925BFEA238E5DA3BC7B5FBA994FA9703627252D088CA83DF2477D6C66ABACAAAA95B8CB51512CD21F3BC8CCC6C27BB2F3AEA0941C735354CB163F7CAAD9641DAAE194F58B353ED3434B73DF2C3D6DB51414E29E09E5EA4BFE829D44322BE8BEA8D3449509C66122E3691332BE52EB9D0E28F8623321EB56E20F65A97F07F67BEAAA7E58AFADB2462664DF5D1B2CAE62AFBD4789517815E9DDD75638625F2D455AE2B0AE5E9585557BA058937147474E821A2BBE957D8E928E9D7A31431FF0059BC272CDAD93E28DA1ECFFC8AF0EDE4D88D92BEDE3829EAB6569E7B92F5751FE28BDE4AFAF45150E066F53ABF08E0A9C71DC911CE0744E3537757C2D4F5749218A68DBB470653C1E37183C722E2AE8432920F2C3EFD17E98B6D2E987F8CE5D07DEA5A0A1A2824A9ABAA91618208C62F248C7000760EB66382AAE2CC4016EE7A3A7A2DA2DAA8FECABCEAD12AEE3B96A0638C17651BE30DE959036024ADAB47A54917D6D136AC3797A5ED5D5ADD4B34EFBA41A74628172C10A683048A344180C05966A7A99E0953559219A48E453EE5D1830F96D1DDFB674A3696EED116B642A9B4576AF0DED05ED94CB2E5F09A96BBBA219B518C65B35A96F1BBEA85EBB3F79E6376DE91A14E92FB2D15745A9A4BC29F84B0B1C1C77C859E338F2E44CAA154C92CAE708E1897C29246EA55EC18B370504E96DDDD6995C0C1EF19541A990F8DB80732D2C7D993BE30F09EC5E596491CF16776663E9624D83C52C9138E0D1BB237CAA41B6EEF201643E05E114604AADC00AA45C16A21E1D20A274C31CCF998599732BE524664D55BCABE43F2D8805638E35CF3CCFA470C7D6EDDBD8AA3563A0B18EEC4DDE1A1AF9406AC93B4C7A6148878058C6F0AE05A4CD88059E47763C59D8B13E724E26D9E19A589FDB46EC8DF2A906C12F0558A63A0BC625CADFF00BB81708E653C0CCB9264E277A065B18A50311810CA7323A36AAE8C3C2561A83C95B58C33208A2A375E18AD74C124D7C90C72FF00C74B4D07DCDC853D4538A30ED057038F2C301D15DFBE1F6B12F4E56C7AB08C36BDB6A2AE00289219694201E0AD14EC917A7B9E4871ECC389E605518B3101476927003E5B25DB09EF54BECC7EED58C3BF48DDB90F7A8B8A84519789E6D32C8B8CF4E1E233E3ACB0F4770AFDAD0F4D7371299063A5A87DF4FEAA4E6DCDF179FA54F6AFF8AEABF594FC83E07777D029F98B54DAD4D2B2D3D4375CB0B0F5BC87AD9D3031331C3A21389B0F83D5FD1A4E6C3F19547D1A9B9925DEFC707A8A238625678D4BC9163C42CF1A9D07191575D7031FBEC7FA62DB41F0E6FD04E66C0FE09AFD6D7972505D507B256D42439BAA38FC29A66D47421843CADA8E8A9B4FDC7F6B2EF48AEABA93A9682EF5DC44C3CB31569D8F8CD2136A2AEF0AF0D94985D359D6CF73D6334B76CCDEE69A7DF5363AE50F1AE988E40A8333B10A8A38B331C1547949205A8B62688E582ED58EAEFC9138DE3B41511879DA5607A705DC8CB454911D23C9338D65D3987CC6D4BF83FB3DF5553DA2A7A6864A8A899C470C30A3492CAEDA2A22202CCC4F000584B56B4D7BEDA601A1A1396A2EBD99623D96BB0C63AEBE53C4A504C144FD2973CAA144D5D5F512D5D5D4399269E662F23B1ED27A87528D1468001C89F146D0FD475FC9B09F81D4BF585E168EEAA965FF000B2E8A6CB7255B9C1EFCBB6052DEA25493ECB5D48B8B5D729E9C91E7A5389099991D4A3A12ACAC08656538156075041D083C3921F7D8FF004C5B697E349BF325AA2FF4196F9DA29AA6E6B965C7A54776D3AAFAB17847AF4649A474BBE193465C2A32E871E6DED73D6C06BAEABD69CE34D9C21A5BCA2E9515E54ECC1B772C2DD1932E1BE819E36EAC3921A18F492754ABAD607C2CFAD3C07DCC71F4C8F6EFAEA073A0BBE3D1D923AAAE3860C669173C301F241130257EE8E7CC399242DECF40A67A7386AD4C5809E13EF6CC255EC19FD168148D6AABA69B1ED8E96148571FE9279B0FBC3E4C68EB3C651DC3507AF7B00CD0B9278EF29CA8F3C4DA93C392B2AFC6970A180F038C9D39D97AFA310C0F6EF38DA55C35A4AE8E5C74D23AA85A23875FB2411E3F7C0F329787464DE60781DD2B4987E4D9DCF176663E938F3A87DF4FEAA4E6DCDF179FA54F6AFF008AEABF594FC83E07777D029F995F178B2504A4F9E1923917F68F4D91732A630550CCD8E55F5B" & _
		"C9AB6009C3B7006DF6CEECFC6557FC9DBED9DD9F8CAAFF0093B13EA95DA7004E024AA24E1D43D67C4F50E487E32A8FA3537329241E2D5539F46F5711E623107C86D246BE0C75851479167C07E6B5F2F5DB4D7DD2D635563514F0ECE45531452644C5639CDED09907BA31279ADFCAEDA0FECAC1FF005BB7F2BB683FB2B07FD6EDFCAEDA0FECAC3FF5AB6C44776554F5B42BB2ABDCF53534DDC734ABEAADE3897A7134E23E9623012BF9F1C792FBDA76E8565E19F662E0EA657A84125F75E9875D35114A446D32C9587038F277057B05BA768207B8EF32D8611455840A6ABD7AE86B441520F5056EDB56DD956863A9A0AA9A9665208E9C2E50918E1D16C3321F194861A1B6CF43200D19BD6919D4F0658E4DEE1F916BCEAA538C9515F572B9F2B4EE79A7CC6D4177DD74CD515125C1B3E58F810C110BAA9CC953553BE11535344B8B4B3CACB1AA8E38E00DE54FB0779457BED6D1AC9EAED7880AD49BBB277F3B2259B3494D4A73AD6D4AA0AC963EFD161063625892C492C5B562C4E24B13A924EA49D49E3CA9F146D0FD475FC9B09F81D4BF585E168A782478A68644962963255E39233991D586A1948C45A5DA5A08912FEBBA3076A6EE8461DD708C1536868E31D4DA2DE70803752913AE656932DA1F7D8FF4C5B69BE349BF452DB1D7703DEA8B636E89801A77EBD0CF78D4B79DE49C79F01CF863E1BC95131FBE60BFB6D5A4FF003A993D1139897F2507369623A896A208C8F23CAAA7F3DAB1DB89A99BE40E5547A1401E8E6D3C5D53EFA06F2ACD04887F3E3E70392829F86E28202EBED65A92F5527A4EF971F35AAAEF3FE7516783E174B9A4870ECDEAEF61270C4EF072D35DFF00CCE2EFDEEAAEA30966F3EEC6EE00480C37445ABE9F8EFA8A5645ED929992A57D2044D879F0EBE652BB1C144CA18FB97E81F474B5F25A6898606395D48F331E4188C463A8E188ECF2636FB5CBF399EDF6B93E733DABA4347B914D4C64122D44ADDFE474869D0AB71058B361D8AD89B50FBE9FD53F36E6F8BBFDE67B57FC5755FACA7E41F03BBBE814FCCBC2A0F8B4C29D4FFA4A89174FEA23D87C1EAFE8D27361F8CAA3E8D4DCCA553A2ACC92C8C782C501DF4ACDD83221D6DBDFBA5507FEB4D9BF6DB683E1CDFA09CCD81FC135FADAF2B434D4E8649EA258E08507179656088BE9622D77ECACFB3EF7B26CB531A03591DEF514893D7CAC27BD26DCC713212D565A3DE63D28E18F5C00B7F22E5FED0D67F06D87F8172FF686B3AFFA1F3DAE9DB2BBE90D22D48F50EF7A6DF354986F1BB22414B3C93B2ABC8D5F77EE9CC8E35962718920DAE4AF97D8E96F3A3964F7BDF287ECE0A49B5F142E30DC57D464F7513C86489C7B978D9594F583CD3E636A2D9FA18A2BBE925B82E06BD26A6C4555F0E6EDA76515D3F86D4F10C0252A910E98BAB1B415D4351252D5D2C8B2C13C2D95E37538823B476A9C55868C08B4D79DCF0C347B554F134F7B5C50288E1BE238C669AF3B9A2EAA955EF95977A785D2969C715E54F8A3687EA3AFE4D84FC0EA5FAC2F0E4A7BCE824C9514EDC0EB1CD130CB3534E874929EA232D14D1B68C8DDB85A2DAAD9F8F2DCB5F36E6B689756B86F62BBC92EF97AC53CC319AEF94F46487A18E74C2D0FBEC7FA62DB4BF1A4DF992DB157D262D1CBB3C971CCDED2B6E0A89A99918FB66A5929A41DA84375F2A43786CBA5E552A5B3559BD6B294B827A20C310C8B9469A71B7F2223FF00E76F1FF85A8AEFA7D86469AB6AA9E96302FDBC31CD3CAB1E3C3A81CDE8B5F14B7446D1DDB4D5F3D3D2A3486522385B77EC87570594904EB81B238D0A32B03E5538DAA197C09DBBAA33ED92A46F837CAC479C736198718A58E51E78DC3FECB5481AABCA668D87068A7EFD130ED191C6A34E6EFF00C5A4867A963F79132A0C7A8B48C805A28BEEB2A47A7BB70BFB6D54C0E2BBE644F7B8FBDC7F90AB68E64F0E275917EF90861FDE2C648FD86A952AE2C380138CCCA0F5E4933A9C3B30B09A418C346A6B25EC6DCE0638F1E037B2E48F5E389B492B9C5E57791CF6B3B1663E926D4D89C15E4DD39F712831B7F735A48FEE6EE9AFB962BFB398B5916B554D1A455D101D2754E8475880714232A4D86A8C33B68D8F315114B3B10AAAA312CC78003B6C97621C64DE6FEBDD4E2A6A30CA94EA7C64A65C431F05A5248F04134D51AE10CF14870EB5570587A5711E9B4F1AF819CB444706864E9C4C3B4142351CA15462CC42A8ED27403E5B434A8711434D0D2920E20C8A319B03EF8CC3D16AFF008AEABF594FC83E07777D029F9522891A492460A88A316663D43FE3C00D4E02C977C2C1F74C64AB95784B53861954F8D1C031453C18E661C6C3E0F57F46939B0FC6551F46A6E6397D2B2B63C891F8F4F4ADABBC808E8BD468AABC777A9C31168BDF63FD35B6D07C38FE82733607F04D7EB6BCAD7AED5D4A830ECDD207A30C349AFCAECD4F7544B88C0B44DBDAC6F6AB4F89C3116796562F24AED248E752CEE73331F393CB7B6C9CCC326D0526377E6E097DD066A8A02B8E8AD5037B49DA77A06BC2CF1B82AE8C51D4E84329C083D841B417A52F7EDA5D9FA34A5BF28D70353795D14A047497D408066A896961C94D78A2E69155127C32F3122891E59646091C71AB3C9239E0A8880B3B1EA55049B3AB02ACB9832B021948D0820EA083C41D45A97F07F67BEAAA7E486AE927969AAA9A459A9EA20731CD0CA871492371AAB03E83C082091696BAEF8E1A4DB2891A5BCAEA882C34BB448A334B78DD71F830DE7862F5977AF46A4E33D3E0E5D495605594956561832B0D0820EA083A1164F8A3687EA3AFE4D84FC0EA5FAC2F0E5952A2115B735E51F71DF5763FB1D651938874D0EEEB291FD71473AF4A" & _
		"39900F019C1A29A8E7EEEB96F331D5DCD788180A8A6DE80D0CC38475B48FDE6AA1E2AE338191D4DB697E349BF325ABB63AF29E3A65BC274AEB8AB673961A2BF634DD2A4AE7D8A0BCA1F5ACADA2ABEE9DB85AA286BA0929AAE96468678255CAF1BAF104761E2AC346521971041E63ED8D7809595314F4BB254920EFB5353229867BEB767514540ACC20988CB35511BAC4464D8B31C59892C4F124EA49F293C891AEB5B40AC1178B54D2639B2A76C94FD23978B47E0F0C39A430208D0823020F941D479AC9935ADA08F214F1AA28C6250A0EB7A6C4A91C4C641F179980D49D001C493C00F2D8D1E9DD755924AB030EF112F4A2A66EC909EFB28F17A2BC71B4727F3749AA7F131338FCAC2C4F6927E5E4078C9774D94F6F72D56A84FB98E7529FD2AF6DBB24BC26F4F73537FB2F31F963E40E38A90C3CEA71169D8709B77503CD3C6B2FFB5CC59A1729221C430F90823832B0D194E2194904606D9CB7A9954C7A432B3D04A7AD9720325293C4A912458F8250600E31494732E3A3475706BE5C1994FCA2DEBAABA2A71C759D667F2E58A0DE313D834D7AEC56EE0FBD20ABD74C00970E0453460B0815C7176266D4AE2BCA94D5B9C6EB4A7AB8D73BC69C7752C7883245ED329CE84F0616C69EA68A75ED5A948CFF00526DDB8F92D9A4928E25EB67AB834F2E0AC5BE416CF049DD75A31093052B4B4F88C33C61F079E51AE42CAB1A1E9F4CAE04927127524F127B4DAAF78C1779415112E3D723342554794E53C91CE9785DE81A968D4A495195D1A2A5862756197886436FB63767CEBFEDB669EF4A6C3DA5324B552FA30548FD2D28167A7BB61781655CB3D54CC1AB275EB8F14EF70427C68E2C4BF07918686C8659162431CE99DCE08A6485D1731EA189B7DB1BB7E75FF6DBED8DD9F3AFFB6DF6C6EDF9D0FDDB11A1C3B351E83D62C90F7552C122574D295A897764A3C102861A1C7556F92DF6C6EDF9D0FDDB1DE5E577A81ED247998FDEA451B1C7C9A5B1A346ACAAF16AEA9024101F6D0521CDBC71D4D504A8FB8F1B3492B17773999D8E249B464F012213E60E09B5F559473254534F58CF0CD1EA922E5518AF934E66C6454D3A4D250ECDF72D5A27182A05E75F26E9FDD64756ECC08B5C1B3B774F1CF886BFAFC9A238AC97B56AE4A7A463A66F53281122230204D34B81C7872C1554D218AA69668EA29E51C639A171244FA6BD17507CBC2C2F7BB248F757D52C179D452A68D775E13822F0A3900E192AD2592323468658CF1C6D05E17754C949594CE2486788E0CAC3FB9918745E3705244251D4A922C67AC61B1F7F49ECD34504951B35784D81267786056AAB9E491BD90449514989C5123D6D9E82BF676F284E1966A4BFAEE0181EBDDD44D04CBE678C116CF7D5FDB377343A66696F682BA7C3AF774976F754F23FB9C063DB6961D8F8AA2AEF49A368A6DAABD22586682375CB24771DDDD314598120D6D4B3D67DCD6204656249666C4924E2598F1249D4927893C6D4F3524C93C4B72DC901743881341774114C9F7D1C8A54F9472C5514F2C904F03ACB0CD1314922910E647471AAB29D4116A8BDAA24A7BAB6B68621257A61BBA3DA6897A26AE9C2F460BE0686A61F63ABD664CAD9815A9AD9D29E0F532FC88CB2782249EE7AD8615F3C92BA20F29E4D8F4A59D267A1D97A7A4AB543AC152B5D5CED0BFBB0AEADE62398FB35B42CC2E1BC2A629A0ACC0BC970DE80858AF2857AE9DF48AF18570DE43DF7C28F5DA57A79E2A980DEB3EEAA206CF0CC83281246C38AB61A7253DDBB674F532BD2C6B0506D3DDE236BE69204F62A6BC22932A5F14716A23DE491D642BA473B0D2D9EE1DA3D9DBE213C035E09755628C31EFB4779F73B2B7510AF20C78311ADB1AAAAB82862F1A6AADA0BA951476E11D44923799109F2584D2D4AEDA5EA98343494C93536CE4128E0F5955288EA6F3553AF73D3C30C4FA6F26CA6CF785E7399E770B1A0002434F047A434B4B0AE11D3D342BD18A18C0551AEAC598C30B4B1D3ACB2C71B4F2E3BA843B0532C98027226399B004E02D574105E14B7AC54D2644AFA22C696A0600E788B856C3AB87116574628E8432B29C19581C41047020F0B66ABF59D5E181A98A3CD4F50DEDAA20419A273E349082A78988589827A29D478C95512E3FEAC851C7A5458774545153A9F19EA636C3FD488C8E7D02C7B8B355556180AD9D024507BAA5A7398B49C46F67E1802910C4D8B312CCC712CC7124F6927527CB65962629221CCAEBC41FF00F75702343A5B3546343587C29E142F493B7B692118BC12378ED16319399F22E380C629A8E74EA64AB8751DB95D95C798A836C6A2A686997B5EA91CFA121DE39F92C3B80354556BEBEA88F22C588C3D6B4C49C1FF00D34FD25F11171B1624924E249D49278924F136AF6660247A610C23C6264953391E4080E6D78728866609056A3D14EE78224F86497C9B998452E241C021B3430B07A7A35147032F82EB068F28F7F9B79363A621C72DDECAC33A526E254F194C12C8A85BEFE3C857FF000FE02DC3FC8F80F93FCABFFFC400291001000202010500020202030101000000011121003141102051617181A1B1F03091C1D1F1E150FFDA0008010100013F21EA08042112840168A04AB466D49417F0A71C8F4594F47F10CF9AE8FCE61C6F0253D03DA0C5E224ACA4088961224C99E401653523901040994E87A346B304DC8A90646321B44F291FBC364B0A38DC1AC4931A927AEDC03765BA856C0D67F43D6FF1E7C740F0EC79BCE81084040614588D2308EF290EC3F06A708C9184793A0C0508251E3CA9C3DB5D7C6476413CECE7F2B1D9E5E9510AD45AD4E07464083E01DFE52F01B8EC3EED498D0C8F0E3830A30A290481" & _
		"F92C8C31DA06BBE2ED909B584CDFBE80CFC160A164044D1C0F643627553D8C205960460F346B5AD26E416C26118BBA5EFD70AB6412EBBA2D680DAF80C7B2B19ED94FE4A7274D5BAC9821112B082528B94305EE4B3E2E601C7D0C49CA094D3BD777A9E273424EAB2697BC84AF2A80B35E86C079B3B3FE503DAD01ED74739F618AD5323421A90787794EC560408979F4E67130E6ECD75482C7DA3419560E05283B590A54EE390B84968888F6A9622B28802E2129416426C40A5DCD90195443042D0D94736A157DAE70FB5F44232781A4864F38A2D1DDAA5D5C47E126A9B40F0940B654223844D278ABF656EF3CFD7F9ECF4ADF1E9BF3ADE46E261F531C9F8C74FCC6B2D158F0D0751CF4463B066D4B73F8540A2A4C92FF0058C025A40CD71261CFFC0A528FFC484911C67CB5141200258888E7EF37CACBF9B6FBBEA4896EDDE5634AAD182EA3CBDF4077E73623E94F949C899C0DC398D3F099E2271BFCC39C1418920C5447A463055E900E302A0EC214DAAD17471F39BF3D58E0919133373889509830DFA40216E4898EC8B6751DE027427B4CDA862613A6EF5C78FC2DB3216FA26B76B663CB84EE467C3825BC3AA52B2BA357D0D7D89CA8B80043910A306030A502A141AC852078003E274FFE1F5680F2AD072E1BFF0054E0DB04D4045AC44650A4B053980056D8E2169E1A50EC809FF39A1F0C0F7E12C9BB6E9070C78E14E595E1DCD00DC4F5F8ECFF009EF0800006000457057DF795BA1D7136836202091FAEB28528264DD41A6464E95628A4C074181831A174390CCA164190599FF5677D218F4272CDB050831AAA859A12201D1D2D18AE5630198157F30645A4E7204FB644D8F87060564D4B08FB9ACBC28F970E6F3C184B7105E735345800D00AD0C606414AC901A41AC95F92E0504ED4B671C3C2F2696E322D852C0A1CF12D6F966FCAC9ED7059008160C2950609261830782CB79C1260C196278A1B8860269CA65F10443047218D909E4E834EE1B3B110715532082997299EA6C211BC02A05CA8E10B3021AF282CB14C088FA15D75D80421A5344A0968DB59559AE750BE2A900A74667B26542522AB954153204F494F3F5FE7B9C9B74FC7B29FF7FEB2464B6C4A393B2D926F7FC4C2B05DEA988DC18224694E1A4BC7E9CFFD127E84FF001DC2A8CD74656F08236854E4E383A2A448429281532B3801CC24F0E639BE32080E33DD5E89EB18F6E097B2C877B30324F2DDA3FBCF0F422E5A52A52328849724F7A39C44B108DFF38838F30E22DA6248891044751E68F867F71FDBF8E30FB993D76D303E9B8EEE823F281207200A11BECDE6A64094044A49425259243BB6D6D5DABB59E5EC3F7CFCC95A73122997D53F1BB210D270A6F2CE0769A1A2F3760A3506CB676D7864392CA6D01E439C7469A8F99C373309C26D22158A25BAF2836A2190201889D4272029284C50991CE00021A64649326846F208B089B171D75C537FA821DA0D7DCE768A66D95BBDF794F3F5FE7B9C9B74FC7B69B23B4B9194FCC9EA986A01ADEB55479282E1CFF791BF89F48F7E7A66E3F9DD698613AA425D77567561FB30DBDBF290C3AD520CB5E9E58178D9B34FBF9BB2CE3D7B367F77FECDBFAC34558F38AF7210C84A20304BD96A547CA921BECE000AAF1819C1D0993D0A8AA7E0C3288F05814988B12E039A40AD625ED3C2E759BBA485BADCBDBFDE78729099C8FC14CAC4BAC0CBC039D7A0A51759C1BE6D4A44B0915242A5EC1E68F874C6651CCBD640490F1827B84CC6D5B37D875EC6FC904D1090AB72EC2EC4CB51DD7EFE06BCFC6227E41C7E6DF057B41B956D26DF91E3E53F843C7A27E876A4E310E6213BF227D8E31A9F5386267D91449E21F985061921253130434893468005C75D2533320383D22F35C472F295C60A3F0116C1691D875C6D708CFF001FEC6724C648886BD4744090019283722E0A92C99C3CEFB6EADFF79E896BC5FF002E425346D819F5B0879693F2D679FAFF003D9FBEFDB7436E9F8F6D31AB08C488BCF73A520AB9DFF858569580AC9E39009D480A4B793708A9DC450EE63146B0EF906C1E0BE5E2B1DE1131A1B86812858BC454688F28013C7C23CFAC9D224D8EAC82C44C84F057B0C07ED10B25285E314A41AE16EF3C1C27B7FBCF0E0F083172630470A39247DD707942A420F2CD53226BA9878E8C679B2E688A2223089089C23A4F1D479A3E1D71CF2AD867A9D8C84B8241125A062B81DD017998BA6F34EF619552C64C7E4A1292EAE07B9C9C84DBBAADB9E85554BCE2D80086A9D0DC434A2D9B7CF278130E3A7C8A4003F849C99C8ABE101CDAC3088211DAE21440614103C4BBE49438CE7B3A4BE2918D768435D02F81A4EF6B00E30333BA2F11F2D80384B1112C525306937138FA426F849FC0606E0116E28D5E246822320A4F1A06AB2472349039576D58A64E253F9C359188A2139752A4F9C674461443CC0F3D49223A64CBCA1B12808D081C90761806CC53035A9F1FC61F23A60A29A4095164604D546F6FC35CFEB03024973B817C8424882C757F04092BE106D50183C35A40F1221346E5D0DBA7E3D94E4E04481007ED4921414E4B523B295F3C6D865BFC0C2B6B01FBF9024201008C191F7A8D9C54AF19733320490BAF2469A48AB2A32AB967CF52B9D0B1E9581663E398266082B0730808E913CE524BA016611A2CDE4D446CB1244BEAF4403A30F9BA615039BF384120E0720041127A919152741D080BD84B9094FC80A0D10D6CA5C1517FCC628F031402243D079A3E1D98C242D5D8C1A2061057309825810116D0E4264561A2AD68926AA509A2CD24385790AE10D844C3D16752127E2083240E3B5649EC6E14EFB40AFB7A02402896289B6B596D14E77D41" & _
		"5005540025574072BC1CE22469319B0121CA072D86DF0AE2E0C11CDB12EC12014002A1002D4B005AD1932B2122615332605D1A833C90406862B3C52FB381C9276C7D52FF003D3F641E4297014130E8C4A0164AEA5911B9F46C9124F4FD46BC3F7184E27E00787CE7CF83B3EE610829250A7A86431145293D3B76B27B186C40AE9088231428FA139C750394A41A517E00C044CE4D2E70BB3670480E2218AAAAAAB2ADAAED5F3D2735AC1B94E04EC74924C27831FECD19815BCBF01913995A3C22F064E5A476A220932DC000C113214150CA8CAAB6ADAE4561EB6B47047C563A72F400C174D1A2291179FF0094C8704B4A83B2048D90262EF2722C8A79438502B5BD04093E74A2169858633F77C388FDE58F8E7FE33294DB4B5C1A0E4BC60B09092A486242BC09B2F17A7C2CC9D811BEAE9A09A169915E441F1767C6F24A3D8461E6968A64CA462FDEAA5F6ABFA3410000184CA159A0447D00AE3DE301B1D20B25C1D8400CE2C23908AF1294380C08F20B9E82244213B09581940D122C20480CADCA3A7DD15F22DB613872F8B92C1199D28C45119B85380979A78F7428ECB0D824D21DE84491C8407520DB4590151D2112C424821480B42774E54B3E0FA72A4522A152AEF269386931F007E13A8662CFDD342A214990DF395C0150B020AC4F00C8EE48C6205803163868F98B970C32E4842504C795D90C620B289D1ED501BF11BCD47400579E1A6CE95846F6FAB1CCA86206778E5F6203C17325A248C4EFBF1C6D3C8F8597F693F4419484641140349616A23D8C3C4632C3CE9094858AB0283117D756D01859CEC4297895A2E115B800A191273662987650429A7BCEE82441016C03BF098466F8C9CB632DA296031A5C9919262096BD803A4D8CDF9C143D6ACA1B52AF387676A41F48FE952841498326BCB3E77F4C64FBB66B7C28C38AC2784726565936AFA52925AE371260A8AF00557332426EB44444E5D4932051B5595B73884416CA3CB50B73AEBC784A0549A9348A0E4A2082925C532442411CBD17A4847862A236A5811883BA0F1DF0783FFC25B69F41C0340F807F9FCFDFEFFF007AC3607E9381E8BE0EC3AC1DD078FF002FFFDA000C03010002000300000010004000800120100000120000800004000824800120800904120004820020004000800004924000004904900104020000004020024000124800104000000104800800020000800120004000020000000920020820900020100020820900120000000000100120000000100020000020800000124104024800100000024124000004000000024124120120820000100000000000000800820024000820800024820104820004000004120900900100000800024000000824004900804020000000000120020120100000120904800020104804900000024924820020004824004000820000124820100924820804000000120004000000000000000000000000004000000000020020000120004800000000FFC40014110100000000000000000000000000000090FFDA0008010301013F10363FFFC40014110100000000000000000000000000000090FFDA0008010201013F10363FFFC4002810010100020104020202020301000000000111002131102041516171B1F0309181C1A1D1F150FFDA0008010100013F10EAC109B16062C01560150CB6339C879387A48488A22CEFA70646EC7B41295063044AAAD89C2787A6B838BBD74A816A41641EDE02325101C6B9CF8007472A040A560D68AAC3704D44512333CDC948711201B41025A89FDBE4E7CB58C0904CAE752174053AB1E740A8416E041C05742E7179ACF3504795211C90629D2A225081488036AA80036AB036B88BBA282110F23008044CFA2B9BFB2D8E4B4452B4E6DA3C6DE4F073EBCE2D3118DF2583550DB9C112888F09B1FA7A05402AA0015558006D550036AC0C5453982217844648A14EC63790CA71E67CB755E16D8DB0C9920D514035FB4FB1F58A66D3D0E4C20FF5F1832B89B44BB43375FE0F81500B092010882883D8D34CE4F4EBEFE714055002ABC07B7E319D871CC48A6F7E81D56AD721A968C811D1664331C62C05BA671A360F572514C875C7B282805000A8600AAAA000AAC0B2C5B287077BECDC400BD140A001554003955D01E57587B550ACE812E2B11528ACDB47F0A1C039471D3BD63E69142A8944013A88D0F6A84ACA81F2A801ED5400DAB0DE147D2128C8583428D8244C6447C7D530294AA0084111E11DA6BD9C9F679FEF8EA6D0368036C001B50002A4015C6C41949480F0507616C4834F29D15031F03CAF88100828A22227B1349F5FEBAB6F39EC40E623A828BDA36311477C27540F8ECD3FF904EB6240C37CD86E2A3CD6C08A147797FBDE46A2FF00E50BE5C36661084D837B83CA8112C00B26AB456110F314806BCF9142F000804A0A4BBE2175683440A7219E7F46DD8410056A0151D5050C555037302412708A0201E1AD26CF19A43C2FC6688CBD5DF9490AADE26737979F2FDF97F9C2A0809DD0E2337A51A937828A760897B87072ED87D1549BE501128954B502C30ACCC0A01C0238A557792BB0B7C13D805B2F4E6AF2DF6B95528A95555556AABB55DABBB8C0A2F61A0C16A808ABB43A62650C800918DAA10AEAC63A8A1231877D5D2BCACEF4305CC1A1512D4A67AA3CE3226C1A24786EA5B801040E59990C08A10D85F3D8C601701608B25672B66D249D1A9188EEE828C59E25ABC1EEBEA28382A4A8743E1285ABE83AA8C18AD3FF0074679D1AC6E5C8C160F2A04D1B94AAEAB5DE1E73C4CE0335AE46B784A661FB712CB8422CF0EE26A09225039BC882200A4B6DCC42AED65555DAF4F415540055000550002A00" & _
		"2A186FA662797F3258114036B5D4CB0C8F2AD605B08F45422912EC0D1D2739FF00AEF47BDFF7BC9B6C5CD771026E8310BF446360B6A957BB37448C2A0080A2441A29683A7CEB03B700B00001268014BCAE2784A455426E3205138E9548468D609CDD8B03D450E129F2E250E609188C5009480B00DA0E01522D382C8AE45635C09B96C1A2833AF92FE598F19D472A227ABF0F454424DD744C3D970C6A46AF13480D154344CAE23DA5CA021041086C6638E424BDA301BC961E239E1AAD0A446718D42F70340F62A00051655C7260B81EEBC5F32EA4A9A05796AA9F2A55DBE7111293481A49F68A0C3056781DBD561C5CE770774BDD14E5A90A8BD020F66F3C268C025D6D20C59B28650981804C28DEB627829108A1A3479A5226FE8EC975415080097B08009D50E4436502940284250A9A987028A3F1DAD769C69DE2009BFB4A4CD9E7F46DDDB9A7EE3D3D80679E13622889B426C476270E3B7375ADDE441A0B5AFF00C394ABAEBD9548F19F8899A799152793649E5D712AE88CC082888C4441447D2BF3C767FD6B7FF8F0FA75D005578A4D145A1CBC10AF8DCDD360E86695956E9FC20CC073A924CBA097D9A69F57919F91CA0177843620C3C2C7BDAA00B496D5C18912678C176E07B9A5139BCF4A089D398525C30D197546FDC7A337E6FF00071AE26DE3CFFC8E6DA5336276010536C602B44D68CC2CC5002765DACE5113099675AB46E38AA514282A4A8D946AAAAAAB6F66A77C35609E9F8F2E294016B0A9A17CEBF4E845862239C0C9365604BBA35565A00BB3DA8442F6A93A3E27688B8D4440DE9688004A920211B6E058C7C8A6A904C2BD749D6396BACCC1871E49222C105C1F08DC740AC36A1F615E25A540AC47D437376031D1540573E80C302829E0E3BF679FD1B776E69FB8F4F68193842C355142C3116DA263FB73C0954AE6D0C12989B2FE8272AA3D04DA280B7A5DA8205E114F5D5704B9EE2A9A34E325F0B33748B4EDF29D04A9F342315778E4DDDB4E2DE1E460BD4E9D3CB3F3A5DA0216252145094B8DB649DD9A6A0FB43D1280C12B89C2B5D1705000000000F01A3F18AEB5238A8BD0A836B8DA7C2DDA5962A1FAB998C08511888A40C0FC2D2B35B556C6FA0422BC776AB890836B62B99A9C6C2AAF3292992E922F618D1F9CC4D7D3248ABD637EE3D1D313C371A16E034C8C34516D7F5CB21518D12FAA17544F4DFD26378806D73901C1AA271DE4A0EC428CE6793627A3870AE06010082251D91C8C840EC0E75F157F36023371C7E6747405D820790813E7B44000641FD9B4D03618D18443810FA05C0B818F42A02A3759E594818962CB5A14F09B0646831296244F84F09EBFD62C17D0BFD6090E8E005F48BD14A84CC8D074AA30A0A0A516EC60894E1DF547E6E4A83C10E975C9ADE1DE3310C007444A2784FAE9B2844D12EEA0333102860C0A801D9003040BCA1A29267EFBFEF04AB47364F564034372C91C980A882F9407CA69B33CFE8DBB0250954F900678E7FCF3E7A34FDC7A7B4091DAE4EB7069B48D88831EE2794E7E1FE12A4FBEE85D0103C7BD00DF4374B154144434A9BF58609CF9B9F15807F47BECFDD7CBAF1BBF7CBB5C42FA937AD05790D52D0B95C21E74F2D4C731F85559AF8207C16E1E2ABF388CA4215C36E242D80DAD21036608AB40742D997700A822CA3B0EA2C6002A95E7363BEA203D3DDAA8FF002A769020E691B97F5CB5BAA60AB95AAAFC9A0C8FCB6BE5C256CE5C8A205408A04444B3AC6FDC7A3AE22D90AA7C20621E2706D858008A81ADD0103AAAED66B3E6158F298BA32EBA29C4E225E30436A0EFA08B040A15003AAF40AA84C7F08E30CF0A735A6862B1108A27C46A11A7660B49E0BCFF003408566E0EC0CCFD108811001082D442602CDBB53A5A3B9055B0763054E0A04379F6AEA434128C1802B6836A189C4BC098AA04F48C24695D4900B33486BFBAB074D09F195723214EB8ED50153C68586D7E2826A34AE86BD064D38DAD1E68A0D63E50B40B9006213A571514040A6482229126FA800A087B1227F91C50AE5B57682DF016ECB1E8B418182A8007B540A17985600FB988DDE10551048491FCE086B9C6B0AA5637311147491EAB1AE10A86284015530D756477B81F888918F469FB8F4F6017EC030A84C0DB14D8AF02FE8898972C6451A3F8794AA815400AAB00F6BE0F972083A60E246463A42EFBDFB49AD9A43DC662108B2657E6130F1D1592AECFBE8DA8C765B6A449A3D021F754D36909D22010181524404E6E1CCD4B8088008011D889A44D89A7F3D35E39C2CB8028485B59C32B2A9D560744C13AC01B97A2383D62251CEFE7CDF9EA0B932E55868BC91E91E08338044E91BF71E8ECC43677344D9DECE0C6D29962E0DE571D271926B330AB37398BF27EDF8C0F66ED86941E762550293DBA05A8BFA697AA972AA945AA83854E8273F8537815F90A2268402222511A27B1F27C9D51338C40000A840054802B8FD76AB483896825D21886089E0F8B99735DCBA97FBF080891619500A8628D2F21B4D8383BCC001E0B98439A487555228263FF00CA021BBED74A860902AEC63A942A90A8317EB692340DEABC40744DCDF2C3783B9AF719E9E30730C6004282D1305105514EC475E5474055539B1B63A21A0684859069E20277A5DC0027650DF80238091EC87B4E1A9A2613044CB17A4F8ADD4420513310522A5B52AAAB5556F4444C5219403DD4401126EB07542AA15B042B054700813C1CD281B5F07233102E0DE43C32623E54401F39D29272A2855571F557EB8371F2A1A3A9A7050F627F64C0D437530C2A9EED09A09DD90D4BBC526DFF00732EEA80B0422A115058D37C8928AD41880C2F4E272DAEEF44CDCF7387C0EC" & _
		"44F345D81A686CA2CB06AE12B2063B69451214E802505432B0C8FE9B960975981A70E69AA0AFAB6C23A563D17ED98D3C6302F50A8228701819C711C64999E315B65F50EAEDDAD010C320A0232A50E3121180B1E3024145495AC1C5DC3AF7D530CF9662B9AA8C4EA0A5C8500F634CBF7EC464F998B8A612C1280516141F6A3A289352259619BFABA7678CC4B697B89D730781A190E08FCD53382370B1988038A1A1B56D4925254E4A7A96B904E4DA2CAB2B2FEC943E85105154B7B433A23C1417C757CF4036F68C0955B107228D33B86B2552E57809279727B8CF84943D32F6118A7A66CFF591DEA41080273512E9D85AD825ECF1F461AC3C92DAE368D46C1855565170E3E9409090B13F18569C3071BA0D52518980043F39D6A701762C66540DC25876E9C1C202FB0AA4B4616E71B0C51723FF00E70A6653B0C26DF7A7625646416324135AE72A0B56082218E53C220513B859102E349586D611888608A68AB50929D0132145FDCCA5E62B311013A16D03DD6317D6412A82A95B89EFB5BFF2C2229AD36AF2F660B0B5C4F9A139233235F5704C5BA9B0DD646E2919C14296011B09546BD69B5D61B11902B29FDB316898A4AE428AA8BECE2B14DF31028212BD5CBB9AF4715B983D77C8055A5A3746020E7C91EB3E9990EAB887927286BDAA6D0BED07003803E80FC76A0F20FD83F9C0380FA03F07FF00093AEFB53FB45CFD1B0F41FCEF3E4A9576AAAAAF2ABB4ED76D7AB106D341F90E2352F617FB01EC010002F07CFEF9EAA720FD83801C01F407E3B54E43F60FE7003803E80FC7F27FFFD9" _
	)


$l_bLulIcon = Binary( _
		 "0x0000010001001C1C000001002000D80C000016000000280000001C000000380000000100200000000000400C0000130B0000130B000000000000000000000000000000000000000000007E9AC500566D950095B9DBF4B7DDFEFFC8E9FBFFD4F3FDFFCAEFFDFFC5EEFEFFCBF6FFFF94B4D599121E330A2B3B4E0019202D002F3B4D00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000095B7E7006F86B419A4C9EDFFC8ECFFFFD5F8FDFFD5F8FEFFCEF2FEFFCCF1FFFFCEF6FFFF708BB0FF4F6387FF4F6282E950617F955465852758668300485A7C007388A400000000000000000000000000000000000000000000000000000000000000000000000000000000007188C10012174D007E9CCB94BEE1FCFFE0FFFFFFDCFDFFFFD4F7FEFFCCF2FDFFCCF3FFFFC8ECFFFF556996FF6B83B1FF667DA4FF516685FF536681FF4F617ED06C7FA425635282006D769E0000000000000000000000000000000000000000000000000000000000000000006E97CF004B6D9B007D9ECC76B3D7FAFFD8FDFFFFDBFDFEFFDCFCFEFFD5F8FEFFD1F9FEFFD2F6FFFFCDEDFFFF99B2E6FF617BA4FF657FA5FF516B89FF49627DFF3E546EFF5E779DFD8BA1D326BBE0FF0047495D00000000000000000000000000000000000000000000000000000000009BC5FF007397CB749ABCE7FFD4F9FFFFDCFFFFFFDBFEFFFFDBFAFFFFD6F9FFFFD9FCFFFFDBFCFFFF92B0CBFF172D48FF10283DFF5A7096FF61799DFF667EA1FF627997FF5B7292FF5C7098EF04060B31CAFAFF0000000000000000000000000000000000000000000000000000000000B8E1FF008CACD419B1D8F2F1AED6F5FFC3ECFCFFDEFFFEFFDBFCFEFFD6F8FEFFDCFCFEFFD6F8FFFF9BBAE2FF496082FF2A405CFF65799FFF829AC6FF839BC8FF8BA5CDFF8298BCFF253551FF000000ED000000000000000000000000000000000000000000000000000000000000000093A2A80096C8FF007D9FCF29A0CAF8FFC5EDFFFFD3F7FFFFDDFEFFFFDCFCFDFFD3F7FFFFC3E8FCFFAECFFBFFA7CBF3FF7291BFFF7B95C3FF95AFDBFF829CC6FF7D97C0FF94ACD5FF405477FF485685FF8A97C73E8197B3007881CA00000000000000000000000000000000000000000000000000B6D7F800879FBF00BDE2FA3DC0E6FFFFDFFFFFFFC4E4FBFFBADEF8FFDDFFFFFFB2D0F5FF98AFECFFB5D8FFFF94BBEAFF85A1D1FF8FABD2FF8EAAD5FF859EC9FF91A7D1FF7387B2FFAFCAF8FFC9E5FFF49AA7D917B4CDFF00A5B5C4000000000000000000000000000000000000000000000000001627400000001200425C74D48DB0CEFF9EC3F9FFCDF2FFFFE1FFFFFFC4E3FFFFBFD0FFFFA1B1E9FF93B3E3FF87AEDDFF93B0D8FF8BA6D2FF8AA3D0FF90A6D2FF859AC5FF839ACBFFA4B9F4FFACC1F6DB9BA7D600BDCFFF00000000000000000000000000000000000000000000000000172E440006172600172E45FC425F83FF93B9EBFFAED3FAFFB1D4FBFF6B7DAFFF262C5EFF040732FF324877FF537BAAFF8EACDBFF8AA0CFFF859DD0FF869CCBFF90A4CFFF6679AAFF5A6BB0FFA9BFFBFF8B9CDA4FA4B9FF00B6C7FF000000000000000000000000000000000000000000263F58000A1B2D00465F83F86381AEFF7DA1D7FF5D77B5FF364380FF00002DFF182137FF6990AFFF375A8DFF436692FF92ACE0FF9FB4E4FF91A6DAFF7F96CAFF8299CCFF697FA8FF6979AAFF626FADFF505CA57D2B37A9006A7BAE0000000000000000000000000000000000000000003C4F6D00000000006E88AE9B80A2CEFF78A0D2FF4E66A5FF25345FFF9AB9C1FFC6EDFFFF82A4DFFF587BAFFF698CBFFFA2BEF3FFB0C9F8FFA1B9E8FF94ACDCFF7F99CFFF6F86B0FF4D5D7EFF5D709DFF283850D0000000000713170000000000000000000000000000000000000000000000000098C4F5006C8BAF4C81A3CDFF7DA3D3FF365386FF5878A9FFA2CAFBFF7E9EDEFF5673A9FF8DA8D4FF98B6ECFFB8D4FCFFCEE7FFFFBDD4FBFFA8C1F3FF91B0E5FF8CA5D7FF41546BFF3A4F62FF112128FF00090C81090B06000D171B00000000000000000000000000000000000000000082A1CF006A84A9107897C2FF7C9DCFFF2F527BFF2C497AFF4B69A2FF507197FF1E3659FF5F73A8FF90ADEBFFC6DFFEFFDCF6FFFFD0E6FFFFB5D3FEFFA4C8F6FF9FBEEFFF7489B2FF36485CFF0C1C26FF0D1920FF172127201C282D0000000000000000000000000000000000000000006A84AC004F5E75006D89B6BB7892C7FF688ABEFF466C9AFF2F4F7AFF374C7CFF2A345FFF687FBAFF99B8EFFFC3E0FFFFB2D6FDFFA5CAF2FF8BB4E2FF96BDEDFFABC8F7FF94ABDAFF465872FF132530FF192A31FF1D282E672738420012191D00000000000000000000000000000000004B546E008FBAF5006884AD437C9DD0FF99B4ECFF8AA7E7FF5D79BAFF849ED4FFB5D2FFFFB3D0FFFFB8D8FFFF99BCE7FF5B7DB3FF456895FF7093C5FF809DCFFFAAC5F5FFA5BCEDFF7386ACFF293D4EFF192C34FF212B348747798A0016161D000000000000000000000000000000000000000000728EBA004F678C007E9FD4EAA5C5F9FFB8D5FEFF98B7EFFFAECDFCFFD0EBFFFFB4D0FFFF98BCF1FF496BA0FF5B7CACFF9EBDEDFF778EBAFF839BCAFFAEC8F6FFADC7F5FF97ADDBFF40556CFF1B2E37FF29323C9400729300302D350000000000000000000000000000000000000000004B5B8400FFFFFF007F9CD37FB1D2FFFFD2F0FFFFC7E6FFFF9CC4F4FF9BC0EAFFC4DFFFFF97B6EEFF587DBAFF799" & _
		 "7CAFF7389B1FF7283A8FFB4D0F6FFB0CAF7FFADC6F3FFABC3F5FF4A5F7AFF213440FF27343E812C4F6600292C3400000000000000000000000000000000000000000000000000A6C8FF007992C100B5D6FACEC2E8FFFF759CC9FF446698FF436898FF99BAE7FFB7D6FFFF6077A5FF2C3B58FF6C809CFFC5DEF6FFC6E5FFFFAFCBF7FFAFC9F7FFB1C9FBFF4D6282FF1C2F3DFF2F3E4B563A4E5D001821280000000000000000000000000000000000000000000000000069758700A3D0FF008EACD0036D95C5EF3C5E8FFF698ABFFF5B7CACFF6986B4FFBCD9FFFFBBD5F9FFC0D8F6FFD6F0FFFFD4EEFFFFC9E5FDFFB8D5FAFFABC6F8FFAECAFDFF596E91FF1B2D3BFF293844193242510000000000000000000000000000000000000000000000000000000000000000003841570088BDFF0059759E586587B8FF617EADFF293A53FF7F98BFFFC3E1FFFFCBE7FFFFCAE6FFFFCBE6FEFFCEE7FDFFC8E2FAFFB8D5F8FFABC8F8FFADC8FDFF52678BFF20303DFE152029001B2936000000000000000000000000000000000000000000000000000000000000000000000000003E526C001F2A3C00506687C5657D9EFF98B4D6FFBEE0FFFFBFE2FFFFC3E3FBFFBFDDFAFFC1DEFAFFCCE7FBFFC6E2FAFFAECBFBFFACC8FFFFA6BDF6FF3A4C69FF1C2C37FF212B34042A3741000000000000000000000000000000000000000000000000000000000000000000000000001A273A00A2C5F500617AA019AAD0FCFEC2ECFFFFBFE3FFFFBBE0FAFFBEDFFBFFBBDEFAFFBDDDFAFFBCDAFAFFB4D3FBFFB1CEFFFFB4CEFFFF64769FFF142331FF1F2F39EA20292E0027343F000000000000000000000000000000000000000000000000000000000000000000000000000000000028436A00FFFFFF0086A9DF35B2D8FFFFBBDDFFFFBFE2FAFFC5E9FBFFC1E5FBFFBBDFFDFFBBDCFFFFBFDAFFFFB3CEFFFF6A80AEFF14212EFF1C2834EC1F2D374D0000000017252E00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000089ACDD0000000000AACCF827B5D7FFE0C7E6FFFFDEFFFFFFF2FFFFFFDBFFFFFFCDEEFFFFADC6FFFF536891FF111F2EFF131D28BF20252F0023293B002A2D350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000626F9000FFFFFF00B4CEFF00C8E7FF57DBFFFF95ADC8E1F692ADCEFF6F86AAFF2A3D59FF0D1928FF182732FF1E2A363A2838470008161C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000B320000063F0000000C8D000918FF0F1F2DFF1B2936FF121E29FF121D28A9121E260016252E00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001C2C38000C131C0018273694152633FC0F1926DC101823630C0D15000F141E000000000000000000000000000000000000000000F803FFF0F0007FF0F0001FF0E0000FF0C00007F0C00007F0E00003F0F00001F0F80001F0F80000F0F80000F0F80000F0F8000070F8000030FC000030FC000030FE000030FE000030FF000030FF000030FF800070FFC00030FFC00070FFE00070FFF001F0FFFC01F0FFFF03F0FFFF87F0" _
    )

$l_BannerPath 		= @TempDir & "\GH Banner.jpg"

$l_LulIconPath			= @TempDir & "\lul.ico"

$l_HoverProcIcon 		= False
$l_HoverProcIconPrev 	= False
$g_ExePath				= "No process selected."

Global $DropFileBuffer 				= 0
Global $g_DllList_SortSense[5] 		= [False, False, False, False, False]
Global $g_DllList_ColumnWidth[5] 	= [0, 0, 0, 0, 0]
	$g_DllList_ColumnWidth[0] = 18
	$g_DllList_ColumnWidth[1] = 120
	$g_DllList_ColumnWidth[2] = 2 * $l_GUIWidth / 3 - 240
	$g_DllList_ColumnWidth[3] = 77
$g_DllList_HeaderText				= "|Filename|Path|Architecture| "
$g_LV_HeaderTextSplit				= _StringExplode($g_DllList_HeaderText, "|")
$g_h_DllListHeader					= 0
$GUI_RECT_Buffer					= 0
Global $g_LV_XY[2] 					= [0, 0]
Global $g_LV_MouseXY[2]				= [0, 0]
$g_LV_PrevHoverIndex				= 0
$g_DllList_HoverHeader				= 0

$l_IgnoreInputChange 			= False
$l_ProcIconIndex				= 0
$l_DoubleClickedDll				= -1
$l_UpdateProcess				= True
$l_ProcessAlive					= False
$l_AutoComplete					= False
$l_ProcessListActive			= False
$l_TargetProcessArchitecture	= 0
$last_tick_250					= 0

$b_HoverClose = False
$b_ClickClose = False
$b_HoverMinimize = False
$b_ClickMinimize = False

$h_P_ProcIcon = 0
Const $g_PI_INDEX_Background_Light 		= 0
Const $g_PI_INDEX_Background_Dark 		= 1
Const $g_PI_INDEX_Inactive	= 2
Const $g_PI_INDEX_Invalid 	= 3
Const $g_PI_INDEX_Console 	= 4
Const $g_PI_INDEX_LUL		= 5
Const $g_PI_INDEX_Valid 	= 6

$h_User32_dll			= 0
$h_Comctl32_DLL			= 0
$h_GUI_LV_SubclassProc 	= 0
$ph_GUI_LV_SubclassProc = 0
$h_D_SelAll 			= 0

Global $h_PM_DllList_All[2] = [0, 0]
Global $h_PM_DllList_Sel[2] = [0, 0]

Global Const $M_Selected	= 0
Global Const $M_All			= 1

;$M_Selected
$A_ID_Toggle 		= 0
$A_ID_Activate 		= 0
$A_ID_Deactivate 	= 0
$A_ID_Select		= 0
$A_ID_Delete 		= 0
$A_ID_Open 			= 0

;$M_ALL
$A_ID_ToggleAll 	= 0
$A_ID_ActivateAll 	= 0
$A_ID_DeactivateAll = 0
$A_ID_SelectAll		= 0
$A_ID_DeleteAll		= 0
$A_ID_DeleteInvalid = 0

;why the fuck is tagMSG not AutoIt standard in WinAPIEx???
Global Const $_tagMSG = "HWND hwnd;UINT message;WPARAM wParam;LPARAM lParam;DWORD time;ptr pt"

#EndRegion

Func CreateGUI()

	FileDelete($l_BannerPath)
	FileWrite($l_BannerPath, $l_bBanner)

	FileDelete($l_LulIconPath)
	FileWrite($l_LulIconPath, $l_bLulIcon)

	If (@AutoItX64) Then
		$l_WindowTitle &= " (64-bit)"
	Else
		$l_WindowTitle &= " (32-bit)"
	EndIf

	$h_GUI = GUICreate($l_WindowTitle, $l_GUIWidth, $l_GUIHeight, $g_MainGUI_X, $g_MainGUI_Y, $WS_POPUP, $WS_EX_ACCEPTFILES)
	If (IsAdmin()) Then
		_WinAPI_ChangeWindowMessageFilterEx($h_GUI, $WM_DROPFILES, $MSGFLT_ALLOW)
		_WinAPI_ChangeWindowMessageFilterEx($h_GUI, $WM_COPYGLOBALDATA, $MSGFLT_ALLOW)
    EndIf

	$h_D_SelAll = GUICtrlCreateDummy()

	$h_P_Banner = GUICtrlCreatePic($l_BannerPath, 0, 0, $l_BannerWidth, $l_BannerHeight, Default, $GUI_WS_EX_PARENTDRAG)

	GUISetFont(17, $FW_BOLD)
	$h_B_Close 	= GUICtrlCreateLabel("", $l_BannerWidth - 1, 0, $l_GUIWidth - $l_BannerWidth + 1, $l_BannerHeight / 2, BitOR($SS_CENTER, $SS_CENTERIMAGE))
		GUICtrlSetBkColor($h_B_Close, 0x2D2D2D)
		GUICtrlSetColor($h_B_Close, 0xD0D0D0)

	$h_B_Minimize = GUICtrlCreateLabel("", $l_BannerWidth - 1, $l_BannerHeight / 2, $l_GUIWidth - $l_BannerWidth + 1, $l_BannerHeight / 2, BitOR($SS_CENTER, $SS_CENTERIMAGE))
		GUICtrlSetBkColor($h_B_Minimize, 0x2D2D2D)
		GUICtrlSetColor($h_B_Minimize, 0xD0D0D0)


	GUISetFont(12, $FW_BOLD)
	$h_B_Settings = CreateGroupBox($h_GUI, " Settings ", 10, 80, $l_GUIWidth / 3 - 15, $l_GUIHeight - 95, $C_GUI_Border[$g_DarkThemeEnabled], BitOR($FW_BOLD, $SS_CENTER))

	GUISetFont(8.5, $FW_NORMAL)

		$h_L_ProcName = GUICtrlCreateLabel("Process:", 20, 105, 45, 20)
		$h_C_ProcName = GUICtrlCreateCombo("", 85, 102, $l_GUIWidth / 3 - 100, 20, BitOR($CBS_AUTOHSCROLL, $CBS_SORT, $CBS_DROPDOWN))
			GUICtrlSetData($h_C_ProcName, $g_ProcessnameList, $g_Processname)

		$h_L_PID = GUICtrlCreateLabel("PID:", 20, 135, 25, 20)
		$h_I_PID = GUICtrlCreateInput($g_PID, 85, 132, 40, 20, $ES_NUMBER)

		GUIStartGroup()
			$h_R_ProcName 	= GUICtrlCreateRadio("", 65, 102, 15, 20)
			$h_R_PID 		= GUICtrlCreateRadio("", 65, 132, 15, 20)

		If ($g_ProcessByName) Then
			GUICtrlSetState($h_R_ProcName, $GUI_CHECKED)
			GUICtrlSetState($h_I_PID, $GUI_DISABLE)
		Else
			GUICtrlSetState($h_R_PID, $GUI_CHECKED)
			GUICtrlSetState($h_C_ProcName, $GUI_DISABLE)
		EndIf

		$h_B_SelProcess = GUICtrlCreateButton("Select process", 156, 131, $l_GUIWidth / 3 - 170, 22)

		$h_L_InjDelay = GUICtrlCreateLabel("Delay:", 20, 165, 35, 20)
		$h_I_InjDelay = GUICtrlCreateInput($g_InjectionDelay, 65, 162, $l_GUIWidth / 3 - 80, 20, $ES_NUMBER)

		$h_C_CloseAI 	= GUICtrlCreateCheckbox("Close after injection", 65, 185)
		If ($g_CloseAfterInjection) Then
			GUICtrlSetState($h_C_CloseAI, $GUI_CHECKED)
		EndIf

		$h_C_AutoI = GUICtrlCreateCheckbox("Auto", 185, 185)
		If ($g_AutoInjection) Then
			GUICtrlSetState($h_C_AutoI, $GUI_CHECKED)
		EndIf

		GUISetFont(9.5, $FW_BOLD)
		$h_B_InjectionMethod = CreateGroupBox($h_GUI, " Method ", 15, 220, $l_GUIWidth / 3 - 25, 70, $C_GUI_Border[$g_DarkThemeEnabled], $SS_LEFT, $C_GUI_Text[$g_DarkThemeEnabled], 8)
		GUISetFont(8.5, $FW_NORMAL)

			$h_C_Method	= GUICtrlCreateCombo("", 20, 235, 121, Default, $CBS_DROPDOWNLIST)
				GUICtrlSetData($h_C_Method, "LoadLibraryExW|LdrLoadDll|ManualMap", "LoadLibraryExW")
				_GUICtrlComboBox_SetCurSel($h_C_Method, $g_InjectionMethod)

				$h_L_HijackHandle = GUICtrlCreateLabel("", 150, 235, 100, 20)
					GUICtrlSetState($h_L_HijackHandle, $GUI_DISABLE)
			$h_C_HijackHandle = GUICtrlCreateCheckbox("Hijack handle", 150, 236, 100, 20)
			If (NOT $g_RunNative) Then
				GUICtrlSetState($h_C_HijackHandle, $GUI_DISABLE)
				GUICtrlSetState($h_L_HijackHandle, $GUI_ENABLE)
				If (BitAND($g_InjectionFlags, $INJ_HIJACK_HANDLE)) Then
					$g_InjectionFlags = BitXOR($g_InjectionFlags, $INJ_HIJACK_HANDLE)
				EndIf
			ElseIf (BitAND($g_InjectionFlags, $INJ_HIJACK_HANDLE)) Then
				GUICtrlSetState($h_C_HijackHandle, $GUI_CHECKED)
			EndIf

			$h_C_LaunchMethod = GUICtrlCreateCombo("", 20, 260, 121, Default, $CBS_DROPDOWNLIST)
				GUICtrlSetData($h_C_LaunchMethod, "NtCreateThreadEx|Thread Hijacking|SetWindowsHookEx|QueueUserAPC", "NtCreateThreadEx")
				_GUICtrlComboBox_SetCurSel($h_C_LaunchMethod, $g_LaunchMethod)

				$h_L_CloakThread = GUICtrlCreateLabel("", 150, 260, 100, 20)
					GUICtrlSetState($h_L_CloakThread, $GUI_DISABLE)
			$h_C_CloakThread = GUICtrlCreateCheckbox("Cloak thread", 150, 261, 100, 20)
			If ($g_LaunchMethod <> 0) Then
				GUICtrlSetState($h_C_CloakThread, $GUI_DISABLE)
				GUICtrlSetState($h_L_CloakThread, $GUI_ENABLE)
			ElseIf (BitAND($g_InjectionFlags, $INJ_THREAD_CREATE_CLOAKED)) Then
				GUICtrlSetState($h_C_CloakThread, $GUI_CHECKED)
			EndIf

		GUISetFont(9.5, $FW_BOLD)
		$h_B_Cloaking = CreateGroupBox($h_GUI, " Cloaking ", 15, 305, $l_GUIWidth / 3 - 25, 65, $C_GUI_Border[$g_DarkThemeEnabled], $SS_LEFT, $C_GUI_Text[$g_DarkThemeEnabled], 8)
		GUISetFont(8.5, $FW_NORMAL)

			GUIStartGroup()
				$h_C_Header = GUICtrlCreateCombo("", 20, 320, 93, Default, $CBS_DROPDOWNLIST)
					GUICtrlSetData($h_C_Header, "Keep PEH|Erase PEH|Fake PEH", "Keep PEH")
				If (BitAND($g_InjectionFlags, $INJ_ERASE_HEADER)) Then
					_GUICtrlComboBox_SetCurSel($h_C_Header, 1)
				ElseIf (BitAND($g_InjectionFlags, $INJ_FAKE_HEADER)) Then
					_GUICtrlComboBox_SetCurSel($h_C_Header, 2)
				EndIf

				$h_C_RandomizeName = GUICtrlCreateCheckbox("Randomize file name", 130, 321, 120, 20)
				If (BitAND($g_InjectionFlags, $INJ_SCRAMBLE_DLL_NAME)) Then
					GUICtrlSetState($h_C_RandomizeName, $GUI_CHECKED)
				EndIf

				$h_B_AdvSettings = GUICtrlCreateButton("Advanced options", 18, 345, 97, 22)

				$h_C_LoadCopy = GUICtrlCreateCheckbox("Load DLL copy", 130, 345, 120, 20)
				If (BitAND($g_InjectionFlags, $INJ_LOAD_DLL_COPY)) Then
					GUICtrlSetState($h_C_LoadCopy, $GUI_CHECKED)
				EndIf

		$h_B_Reset = GUICtrlCreateButton("Reset settings", 25, $l_GUIHeight - 43, $l_GUIWidth / 8, 22)

		$h_B_SwitchTheme = GUICtrlCreateButton("", $l_GUIWidth / 3 - $l_GUIWidth / 8 - 20, $l_GUIHeight - 43, $l_GUIWidth / 8, 22)
		If (NOT $g_DarkThemeEnabled) Then
			GUICtrlSetData($h_B_SwitchTheme, "Dark theme")
			GUICtrlSetColor($h_B_SwitchTheme, $C_GUI_Text[1])
			GUICtrlSetBkColor($h_B_SwitchTheme, $C_GUI_Ctrl_Button[1])
		Else
			GUICtrlSetData($h_B_SwitchTheme, "Light theme")
		EndIf

	GUISetFont(12, $FW_BOLD)
	$h_B_Files = CreateGroupBox($h_GUI, " Files ", $l_GUIWidth / 3 + 5, 80, 2 * $l_GUIWidth / 3 - 15, $l_GUIHeight - 143, $C_GUI_Border[$g_DarkThemeEnabled])
	GUISetFont(8.5, $FW_NORMAL)

		$g_hDllList = GUICtrlCreateListView($g_DllList_HeaderText, $l_GUIWidth / 3 + 10, 95, $l_DllListWidth, $l_GUIHeight - 200, $LVS_REPORT, BitOR($LVS_EX_FULLROWSELECT, $LVS_EX_CHECKBOXES, $LVS_EX_FLATSB))
			$g_h_DllListHeader = _GUICtrlListView_GetHeader($g_hDllList)

			For $i = 0 To 4 Step 1
				_GUICtrlListView_SetColumnWidth($g_hDllList, $i, $g_DllList_ColumnWidth[$i])
			Next


			LoadFiles($g_hDllList)

			$g_LV_XY[0] = $l_GUIWidth / 3 + 10
			$g_LV_XY[1] = 95

			GUICtrlSetState($g_hDllList, $GUI_DROPACCEPTED)

		$h_B_Add 	= GUICtrlCreateButton("Add files", $l_GUIWidth / 3 + 15, $l_GUIHeight - 95, $l_GUIWidth / 6, 22)
		$h_B_Inject = GUICtrlCreateButton("Inject", 2 * $l_GUIWidth / 3 - $l_GUIWidth / 12, $l_GUIHeight - 95, $l_GUIWidth / 6, 22)
		$h_B_Remove	= GUICtrlCreateButton("Remove selected files", $l_GUIWidth - $l_GUIWidth / 6 - 20, $l_GUIHeight - 95, $l_GUIWidth / 6, 22)

	GUISetFont(12, $FW_BOLD)
	$h_B_Info = CreateGroupBox($h_GUI, " Info ", $l_GUIWidth / 3 + 5, $l_GUIHeight - 51, 2 * $l_GUIWidth / 3 - 15, 36, $C_GUI_Border[$g_DarkThemeEnabled])
	GUISetFont(8.5, $FW_NORMAL)

		$h_B_ToggleTips	= GUICtrlCreateButton("Disable Tooltips", $l_GUIWidth / 3 + 15, $l_GUIHeight - 43, $l_GUIWidth / 8, 22)
		$h_B_Help 		= GUICtrlCreateButton("Help", 37 * $l_GUIWidth / 72 + 10 / 3, $l_GUIHeight - 43, $l_GUIWidth / 8, 22)
		$h_B_Changelog 	= GUICtrlCreateButton("Changelog", 25 * $l_GUIWidth / 36 - 25 / 3, $l_GUIHeight - 43, $l_GUIWidth / 8, 22)
		$h_L_Version 	= GUICtrlCreateLabel("Version " & $g_CurrentVersion, 7 * $l_GUIWidth / 8 - 20, $l_GUIHeight - 42, $l_GUIWidth / 8, 21, BitOR($SS_SUNKEN, $SS_CENTER))
			GUICtrlSetFont($h_L_Version, 12, $FW_BOLD)
			If (Number($g_CurrentVersion) < Number($g_NewestVersion)) Then
				GUICtrlSetColor($h_L_Version, 0xFF0000)
				GUICtrlSetCursor($h_L_Version, 0)
			ElseIf (Number($g_CurrentVersion) > Number($g_NewestVersion)) Then
				GUICtrlSetColor($h_L_Version, 0x0000FF)
			Else
				GUICtrlSetColor($h_L_Version, 0x33DD33)
			EndIf

	$h_T_MenuBar = _GUIToolTip_Create($h_GUI)
    _GUIToolTip_SetDelayTime($h_T_MenuBar, $TTDT_AUTOPOP, 32767)
    _GUIToolTip_SetMaxTipWidth($h_T_MenuBar, 1000)
	_GUIToolTip_SetTitle($h_T_MenuBar, "")
	_GUIToolTip_AddTool($h_T_MenuBar, 0, "Minimize", GUICtrlGetHandle($h_B_Minimize))
	_GUIToolTip_AddTool($h_T_MenuBar, 0, "Close", GUICtrlGetHandle($h_B_Close))

	$h_T_TooltipCtrl = _GUIToolTip_Create($h_GUI)
    _GUIToolTip_SetDelayTime($h_T_TooltipCtrl, $TTDT_AUTOPOP, 32767)
    _GUIToolTip_SetMaxTipWidth($h_T_TooltipCtrl, 1000)
	_GUIToolTip_SetTitle($h_T_TooltipCtrl, "Info", $TTI_INFO)

	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Select the target process by it's executable name (not unique).", GUICtrlGetHandle($h_L_ProcName))
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Select the target process by it's executable name (not unique).", GUICtrlGetHandle($h_R_ProcName))
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Select the target process by it's identifier (unique but changes when the process restarts).", GUICtrlGetHandle($h_L_PID))
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Select the target process by it's identifier (unique but changes when the process restarts).", GUICtrlGetHandle($h_R_PID))
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Select a process using the ProcessList.", GUICtrlGetHandle($h_B_SelProcess))

	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Delays the injection (in ms).", GUICtrlGetHandle($h_L_InjDelay))
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "The injector automatically closes after injecting the checkmarked dll(s).", GUICtrlGetHandle($h_C_CloseAI))
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "If the injector finds the target process, it automatically injects the checkmarked dll(s).", GUICtrlGetHandle($h_C_AutoI))

	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "LoadLibraryExW is the default injection method which simply uses LoadLibraryExW." & @CRLF & _
		"LdrLoadDll is an advanced injection method which uses LdrLoadDll and bypasses LoadLibrary(Ex) hooks." & @CRLF & _
		"ManualMap is an advanced injection technique which bypasses most module detection methods.", GUICtrlGetHandle($h_C_Method))
	If (NOT $g_RunNative) Then
		_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Hijacks a handle from another process. To use this method please run the 64-bit version of the injector.", GUICtrlGetHandle($h_L_HijackHandle));dummy label
	Else
		_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Hijacks a handle from another process.", GUICtrlGetHandle($h_C_HijackHandle))
	EndIf
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "NtCreateThreadEx: Creates a simple remote thread to load the dll(s)." & @CRLF & _
		"Thread hijacking: Redirects a thread to a codecave to load the dll(s)." & @CRLF & _
		"SetWindowsHookEx: Adds a hook into the window callback list which then loads the dll(s)." & @CRLF & _
		"QueueUserAPC: Registers an asynchronous procedure call to the process' threads which then loads the dll(s).", GUICtrlGetHandle($h_C_LaunchMethod))
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Attempts to hide the thread from debuggers, fakes the startaddress and disables thread attach/detach calls.", GUICtrlGetHandle($h_L_CloakThread));dummy label
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Attempts to hide the thread from debuggers, fakes the startaddress and disables thread attach/detach calls.", GUICtrlGetHandle($h_C_CloakThread))

	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Keep PEH: Doesn't modify the PE header of the dll(s)." & @CRLF & _
		"Erase PEH: Erases the PE header by wrting 0's to it to avoid detections." & @CRLF & _
		"Fake PEH: Replaces the PE header with the PE header of a normal windows module (eg. kernel32.dll).", GUICtrlGetHandle($h_C_Header))
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Renames the dll(s) randomly before injecting it/them.", GUICtrlGetHandle($h_C_RandomizeName))
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Click to configure advanced cloaking options.", GUICtrlGetHandle($h_B_AdvSettings))
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Creates a copy of the dll(s) in the user's temp directory which then get(s) loaded into the target process.", GUICtrlGetHandle($h_C_LoadCopy))

	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Select files from disk to add them to the list or drag & drop them into the listview above.", GUICtrlGetHandle($h_B_Add))
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Inject checkmarked dll(s) into the selected process.", GUICtrlGetHandle($h_B_Inject))
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Remove highlighted entries from the list.", GUICtrlGetHandle($h_B_Remove))

	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "You won't have to see this again.", GUICtrlGetHandle($h_B_ToggleTips))
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Open the release thread (guidedhacking.com/ghinjector) for support.", GUICtrlGetHandle($h_B_Help))
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Open the changelog on pastebin.", GUICtrlGetHandle($h_B_Changelog))
	If (Number($g_CurrentVersion) < Number($g_NewestVersion)) Then
		_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Your version of the GH Injector is outdated. Click to update.", GUICtrlGetHandle($h_L_Version))
	ElseIf (Number($g_CurrentVersion) > Number($g_NewestVersion)) Then
		_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Shit mate, your version is from the future.", GUICtrlGetHandle($h_L_Version))
	Else
		_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "You're using the newest version of the GH Injector.", GUICtrlGetHandle($h_L_Version))
	EndIf

	If ($g_ToolTipsOn = False) Then
		_GUIToolTip_Deactivate($h_T_TooltipCtrl)
		GUICtrlSetData($h_B_ToggleTips, "Enable Tooltips")
	EndIf

	GUIRegisterMsg($WM_NOTIFY,	 	"WM_NOTIFY")
	GUIRegisterMsg($WM_DROPFILES, 	"WM_DROPFILES")
	GUIRegisterMsg($WM_COMMAND, 	"WM_COMMAND")
	GUIRegisterMsg($WM_MOVE,		"WM_MOVE")
	GUIRegisterMsg($WM_PAINT,		"WM_PAINT")
	GUIRegisterMsg($WM_CTLCOLORLISTBOX, "WM_CTLCOLORLISTBOX")

	$g_ShortStruct = DllStructCreate($g_tagShort)

	$G_HBRUSH_SuperDark = _WinAPI_CreateSolidBrush($C_GUI_Ctrl_Listview[1])
	$G_HBRUSH_Dark 		= _WinAPI_CreateSolidBrush(RGBToBGR($C_GUI[1]))
	$G_HBRUSH_SemiDark	= _WinAPI_CreateSolidBrush(RGBToBGR(0x666666))
	$G_HBRUSH_Light 	= _WinAPI_CreateSolidBrush(RGBToBGR(0x888888))

	$HDC_DLL_LVH		= _WinAPI_GetDC($g_h_DllListHeader)
	$HFONT_LVH 			= _SendMessage($g_h_DllListHeader, $WM_GETFONT)
	$HGDIOBJ_LVH_Font 	= _WinAPI_SelectObject($HDC_DLL_LVH, $HFONT_LVH)
	$LOGFONT_LVH_Font 	= DllStructCreate($tagLOGFONT)

	_WinAPI_GetObject	($HFONT_LVH, DllStructGetSize($LOGFONT_LVH_Font), DllStructGetPtr($LOGFONT_LVH_Font))
	_WinAPI_SelectObject($HDC_DLL_LVH, $HGDIOBJ_LVH_Font)
	_WinAPI_ReleaseDC	($g_h_DllListHeader, $HDC_DLL_LVH)

	$LOGFONT_LVH_Font.Weight = BitOR($LOGFONT_LVH_Font.Weight, $FW_BOLD)
	$G_HFONT_LV_Font = _WinAPI_CreateFontIndirect($LOGFONT_LVH_Font)
	$GUI_RECT_Buffer = DllStructCreate($tagRECT)

	$g_kernel32_dll = DllOpen("kernel32.dll")
	$h_User32_dll	= DllOpen("User32.dll")
	$h_Comctl32_DLL = DllOpen("Comctl32.dll")
    $h_GUI_LV_SubclassProc 		= DllCallbackRegister("GUI_LV_SubclassProc", 'LRESULT', 'HWND;UINT;WPARAM;LPARAM;UINT_PTR;DWORD_PTR')
	$ph_GUI_LV_SubclassProc 	= DllCallbackGetPtr($h_GUI_LV_SubclassProc)
	_WinAPI_SetWindowSubclass(GUICtrlGetHandle($g_hDllList), $ph_GUI_LV_SubclassProc, 1, 0)

	Local $Accel_CtrlA[1][2] = [[ "^a", $h_D_SelAll ]]
    GUISetAccelerators($Accel_CtrlA)

	$h_P_ProcIcon = _GUIImageList_Create(20, 20, 5, 1)
		$hBmp_light = _WinAPI_CreateSolidBitmap($h_GUI, $C_GUI_ProcIconList[0], 20, 20)
		$hBmp_dark 	= _WinAPI_CreateSolidBitmap($h_GUI, $C_GUI_ProcIconList[1], 20, 20)

		_GUIImageList_Add($h_P_ProcIcon, $hBmp_light)
		_GUIImageList_Add($h_P_ProcIcon, $hBmp_dark)
		_GUIImageList_AddIcon($h_P_ProcIcon, @SystemDir & "\shell32.dll", 131, True)
		_GUIImageList_AddIcon($h_P_ProcIcon, @SystemDir & "\imageres.dll", 11, True)
		_GUIImageList_AddIcon($h_P_ProcIcon, @SystemDir & "\cmd.exe", 0, True)
		_GUIImageList_AddIcon($h_P_ProcIcon, $l_LulIconPath, 0, True)

		_WinAPI_DeleteObject($hBmp_dark)
		_WinAPI_DeleteObject($hBmp_light)

	$h_G_AdvSettings = GUICreate("", 239, 55, 14, 220, BitOR($WS_POPUP, $WS_BORDER), Default, $h_GUI)

	$h_B_AdvSettingsB = CreateGroupBoxNoText(0, 0, 238, 54, $C_GUI_Border[0])

		$h_L_Unlink = GUICtrlCreateLabel("", 140, 321, 100, 20)
			GUICtrlSetState($h_L_Unlink, $GUI_DISABLE)
		$h_C_Unlink = GUICtrlCreateCheckbox("Unlink from PEB", 5, 5, 100, 20)
			If (BitAND($g_InjectionFlags, $INJ_UNLINK_FROM_PEB)) Then
				GUICtrlSetState($h_C_Unlink, $GUI_CHECKED)
			EndIf
			If ($g_InjectionMethod = 2) Then
				GUICtrlSetState($h_C_Unlink, BitOr($GUI_CHECKED, $GUI_DISABLE))
				GUICtrlSetState($h_L_Shift, $GUI_ENABLE)
			EndIf
		$h_L_Shift = GUICtrlCreateLabel("", 140, 5, 80, 20)
			GUICtrlSetState($h_L_Shift, $GUI_DISABLE)
		$h_C_Shift = GUICtrlCreateCheckbox("Shift module", 140, 5, 80, 20)

		$h_L_Clean = GUICtrlCreateLabel("", 5, 30, 125, 20)
			GUICtrlSetState($h_L_Clean, $GUI_DISABLE)
		$h_C_Clean = GUICtrlCreateCheckbox("Clean data directories", 5, 30, 125, 20)

		If ($g_InjectionMethod <> 2) Then
			GUICtrlSetState($h_C_Shift, $GUI_DISABLE)
			GUICtrlSetState($h_C_Clean, $GUI_DISABLE)
			GUICtrlSetState($h_L_Shift, $GUI_ENABLE)
			GUICtrlSetState($h_L_Clean, $GUI_ENABLE)
		Else
			If (BitAND($g_InjectionFlags, $INJ_SHIFT_MODULE)) Then
				GUICtrlSetState($h_C_Shift, $GUI_CHECKED)
			EndIf
			If (BitAND($g_InjectionFlags, $INJ_CLEAN_DATA_DIR)) Then
				GUICtrlSetState($h_C_Clean, $GUI_CHECKED)
			EndIf
		EndIf

	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Shifts the image by a randomly generated amount of bytes (manual mapping only).", GUICtrlGetHandle($h_L_Shift));dummy label
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Shifts the image by a randomly generated amount of bytes (manual mapping only).", GUICtrlGetHandle($h_C_Shift))
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Removes unnecessary data from the data directory of the image (manual mapping only).", GUICtrlGetHandle($h_L_Clean));dummy label
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Removes unnecessary data from the data directory of the image (manual mapping only).", GUICtrlGetHandle($h_C_Clean))
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Removes the list entry of the dll(s) from the lists in the process enviroment block (not needed for manual mapping).", GUICtrlGetHandle($h_L_Unlink));dummy label
	_GUIToolTip_AddTool($h_T_TooltipCtrl, 0, "Removes the list entry of the dll(s) from the lists in the process enviroment block (not needed for manual mapping).", GUICtrlGetHandle($h_C_Unlink))

	$h_PM_DllList_All[0] = _PopUpMenu_Create($h_GUI, 180, 23, True)
		$A_ID_ToggleAll 	= _PopUpMenu_AddOption($h_PM_DllList_All[0], "Toggle all", True, $C_GUI_Ctrl_PopUpMenuBgDef[0], $C_GUI_Ctrl_PopUpMenuBgHov[0], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[0], $C_GUI_Ctrl_PopUpMenuTxHov[0], Default, @SystemDir & '\shell32.dll', 238)
		$A_ID_ActivateAll	= _PopUpMenu_AddOption($h_PM_DllList_All[0], "Activate all", True, $C_GUI_Ctrl_PopUpMenuBgDef[0], $C_GUI_Ctrl_PopUpMenuBgHov[0], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[0], $C_GUI_Ctrl_PopUpMenuTxHov[0], Default, @SystemDir & '\shell32.dll', 296)
		$A_ID_DeactivateAll	= _PopUpMenu_AddOption($h_PM_DllList_All[0], "Deactivate all", True, $C_GUI_Ctrl_PopUpMenuBgDef[0], $C_GUI_Ctrl_PopUpMenuBgHov[0], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[0], $C_GUI_Ctrl_PopUpMenuTxHov[0], Default, @SystemDir & '\shell32.dll', 131)
		$A_ID_SelectAll 	= _PopUpMenu_AddOption($h_PM_DllList_All[0], "Select all", True, $C_GUI_Ctrl_PopUpMenuBgDef[0], $C_GUI_Ctrl_PopUpMenuBgHov[0], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[0], $C_GUI_Ctrl_PopUpMenuTxHov[0], Default, @SystemDir & '\shell32.dll', 165)
		$A_ID_DeleteAll		= _PopUpMenu_AddOption($h_PM_DllList_All[0], "Delete all", True, $C_GUI_Ctrl_PopUpMenuBgDef[0], $C_GUI_Ctrl_PopUpMenuBgHov[0], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[0], $C_GUI_Ctrl_PopUpMenuTxHov[0], Default, @SystemDir & '\shell32.dll', 32)
		$A_ID_DeleteInvalid	= _PopUpMenu_AddOption($h_PM_DllList_All[0], "Delete invalid files", True, $C_GUI_Ctrl_PopUpMenuBgDef[0], $C_GUI_Ctrl_PopUpMenuBgHov[0], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[0], $C_GUI_Ctrl_PopUpMenuTxHov[0], Default, @SystemDir & '\shell32.dll', 271)

	$h_PM_DllList_All[1] = _PopUpMenu_Create($h_GUI, 180, 23, True)
		_PopUpMenu_AddOption($h_PM_DllList_All[1], "Toggle all", True, $C_GUI_Ctrl_PopUpMenuBgDef[1], $C_GUI_Ctrl_PopUpMenuBgHov[1], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[1], $C_GUI_Ctrl_PopUpMenuTxHov[1], Default, @SystemDir & '\shell32.dll', 238)
		_PopUpMenu_AddOption($h_PM_DllList_All[1], "Activate all", True, $C_GUI_Ctrl_PopUpMenuBgDef[1], $C_GUI_Ctrl_PopUpMenuBgHov[1], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[1], $C_GUI_Ctrl_PopUpMenuTxHov[1], Default, @SystemDir & '\shell32.dll', 296)
		_PopUpMenu_AddOption($h_PM_DllList_All[1], "Deactivate all", True, $C_GUI_Ctrl_PopUpMenuBgDef[1], $C_GUI_Ctrl_PopUpMenuBgHov[1], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[1], $C_GUI_Ctrl_PopUpMenuTxHov[1], Default, @SystemDir & '\shell32.dll', 131)
		_PopUpMenu_AddOption($h_PM_DllList_All[1], "Select all", True, $C_GUI_Ctrl_PopUpMenuBgDef[1], $C_GUI_Ctrl_PopUpMenuBgHov[1], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[1], $C_GUI_Ctrl_PopUpMenuTxHov[1], Default, @SystemDir & '\shell32.dll', 165)
		_PopUpMenu_AddOption($h_PM_DllList_All[1], "Delete all", True, $C_GUI_Ctrl_PopUpMenuBgDef[1], $C_GUI_Ctrl_PopUpMenuBgHov[1], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[1], $C_GUI_Ctrl_PopUpMenuTxHov[1], Default, @SystemDir & '\shell32.dll', 32)
		_PopUpMenu_AddOption($h_PM_DllList_All[1], "Delete invalid files", True, $C_GUI_Ctrl_PopUpMenuBgDef[1], $C_GUI_Ctrl_PopUpMenuBgHov[1], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[1], $C_GUI_Ctrl_PopUpMenuTxHov[1], Default, @SystemDir & '\shell32.dll', 271)

	$h_PM_DllList_Sel[0] = _PopUpMenu_Create($h_GUI, 180, 23, True)
		$A_ID_Toggle 		= _PopUpMenu_AddOption($h_PM_DllList_Sel[0], "Toggle", True, $C_GUI_Ctrl_PopUpMenuBgDef[0], $C_GUI_Ctrl_PopUpMenuBgHov[0], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[0], $C_GUI_Ctrl_PopUpMenuTxHov[0], Default, @SystemDir & '\shell32.dll', 238)
		$A_ID_Activate 		= _PopUpMenu_AddOption($h_PM_DllList_Sel[0], "Activate", True, $C_GUI_Ctrl_PopUpMenuBgDef[0], $C_GUI_Ctrl_PopUpMenuBgHov[0], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[0], $C_GUI_Ctrl_PopUpMenuTxHov[0], Default, @SystemDir & '\shell32.dll', 296)
		$A_ID_Deactivate 	= _PopUpMenu_AddOption($h_PM_DllList_Sel[0], "Deactivate", True, $C_GUI_Ctrl_PopUpMenuBgDef[0], $C_GUI_Ctrl_PopUpMenuBgHov[0], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[0], $C_GUI_Ctrl_PopUpMenuTxHov[0], Default, @SystemDir & '\shell32.dll', 131)
		$A_ID_Select		= _PopUpMenu_AddOption($h_PM_DllList_Sel[0], "Select all", True, $C_GUI_Ctrl_PopUpMenuBgDef[0], $C_GUI_Ctrl_PopUpMenuBgHov[0], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[0], $C_GUI_Ctrl_PopUpMenuTxHov[0], Default, @SystemDir & '\shell32.dll', 165)
		$A_ID_Delete 		= _PopUpMenu_AddOption($h_PM_DllList_Sel[0], "Delete", True, $C_GUI_Ctrl_PopUpMenuBgDef[0], $C_GUI_Ctrl_PopUpMenuBgHov[0], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[0], $C_GUI_Ctrl_PopUpMenuTxHov[0], Default, @SystemDir & '\shell32.dll', 32)
		$A_ID_Open			= _PopUpMenu_AddOption($h_PM_DllList_Sel[0], "Open location", True, $C_GUI_Ctrl_PopUpMenuBgDef[0], $C_GUI_Ctrl_PopUpMenuBgHov[0], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[0], $C_GUI_Ctrl_PopUpMenuTxHov[0], Default, @SystemDir & '\shell32.dll', 45)

	$h_PM_DllList_Sel[1] = _PopUpMenu_Create($h_GUI, 180, 23, True)
		_PopUpMenu_AddOption($h_PM_DllList_Sel[1], "Toggle", True, $C_GUI_Ctrl_PopUpMenuBgDef[1], $C_GUI_Ctrl_PopUpMenuBgHov[1], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[1], $C_GUI_Ctrl_PopUpMenuTxHov[1], Default, @SystemDir & '\shell32.dll', 238)
		_PopUpMenu_AddOption($h_PM_DllList_Sel[1], "Activate", True, $C_GUI_Ctrl_PopUpMenuBgDef[1], $C_GUI_Ctrl_PopUpMenuBgHov[1], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[1], $C_GUI_Ctrl_PopUpMenuTxHov[1], Default, @SystemDir & '\shell32.dll', 296)
		_PopUpMenu_AddOption($h_PM_DllList_Sel[1], "Deactivate", True, $C_GUI_Ctrl_PopUpMenuBgDef[1], $C_GUI_Ctrl_PopUpMenuBgHov[1], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[1], $C_GUI_Ctrl_PopUpMenuTxHov[1], Default, @SystemDir & '\shell32.dll', 131)
		_PopUpMenu_AddOption($h_PM_DllList_Sel[1], "Select all", True, $C_GUI_Ctrl_PopUpMenuBgDef[1], $C_GUI_Ctrl_PopUpMenuBgHov[1], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[1], $C_GUI_Ctrl_PopUpMenuTxHov[1], Default, @SystemDir & '\shell32.dll', 165)
		_PopUpMenu_AddOption($h_PM_DllList_Sel[1], "Delete", True, $C_GUI_Ctrl_PopUpMenuBgDef[1], $C_GUI_Ctrl_PopUpMenuBgHov[1], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[1], $C_GUI_Ctrl_PopUpMenuTxHov[1], Default, @SystemDir & '\shell32.dll', 32)
		_PopUpMenu_AddOption($h_PM_DllList_Sel[1], "Open location", True, $C_GUI_Ctrl_PopUpMenuBgDef[1], $C_GUI_Ctrl_PopUpMenuBgHov[1], _
			Default, $C_GUI_Ctrl_PopUpMenuTxDef[1], $C_GUI_Ctrl_PopUpMenuTxHov[1], Default, @SystemDir & '\shell32.dll', 45)

	UpdateTheme($g_DarkThemeEnabled)

	GUISetState(@SW_SHOW, $h_GUI)

	UpdateTargetProcess()

	Return $h_GUI

EndFunc   ;==>CreateGUI

Func UpdateTheme($bEnableDarkTheme = False)

	$g_DarkThemeEnabled = $bEnableDarkTheme

	GUISetState(@SW_LOCK, $h_GUI)

	If ($g_DarkThemeEnabled) Then
		DllCall("UxTheme.dll", "int", "SetWindowTheme", "HWND", GUICtrlGetHandle($h_C_CloseAI), "wstr", "", "wstr", "")
		DllCall("UxTheme.dll", "int", "SetWindowTheme", "HWND", GUICtrlGetHandle($h_C_AutoI), "wstr", "", "wstr", "")
		DllCall("UxTheme.dll", "int", "SetWindowTheme", "HWND", GUICtrlGetHandle($h_C_HijackHandle), "wstr", "", "wstr", "")
		DllCall("UxTheme.dll", "int", "SetWindowTheme", "HWND", GUICtrlGetHandle($h_C_CloakThread), "wstr", "", "wstr", "")
		DllCall("UxTheme.dll", "int", "SetWindowTheme", "HWND", GUICtrlGetHandle($h_C_Unlink), "wstr", "", "wstr", "")
		DllCall("UxTheme.dll", "int", "SetWindowTheme", "HWND", GUICtrlGetHandle($h_C_LoadCopy), "wstr", "", "wstr", "")
		DllCall("UxTheme.dll", "int", "SetWindowTheme", "HWND", GUICtrlGetHandle($h_C_ProcName), "wstr", "", "wstr", "")
		DllCall("UxTheme.dll", "int", "SetWindowTheme", "HWND", GUICtrlGetHandle($h_C_Method), "wstr", "", "wstr", "")
		DllCall("UxTheme.dll", "int", "SetWindowTheme", "HWND", GUICtrlGetHandle($h_C_LaunchMethod), "wstr", "", "wstr", "")
		DllCall("UxTheme.dll", "int", "SetWindowTheme", "HWND", GUICtrlGetHandle($h_C_Header), "wstr", "", "wstr", "")

		DllCall("UxTheme.dll", "int", "SetWindowTheme", "HWND", GUICtrlGetHandle($h_C_RandomizeName), "wstr", "", "wstr", "")
		DllCall("UxTheme.dll", "int", "SetWindowTheme", "HWND", GUICtrlGetHandle($h_C_Shift), "wstr", "", "wstr", "")
		DllCall("UxTheme.dll", "int", "SetWindowTheme", "HWND", GUICtrlGetHandle($h_C_Clean), "wstr", "", "wstr", "")

		GUICtrlSetColor($h_B_SwitchTheme, $C_GUI_Text[0])
		GUICtrlSetBkColor($h_B_SwitchTheme, $C_GUI_Ctrl_Button[0])
		GUICtrlSetData($h_B_SwitchTheme, "Light mode")
	Else
		_WinAPI_SetWindowTheme(GUICtrlGetHandle($h_C_CloseAI), "DarkMode_Explorer")
		_WinAPI_SetWindowTheme(GUICtrlGetHandle($h_C_AutoI), "DarkMode_Explorer")
		_WinAPI_SetWindowTheme(GUICtrlGetHandle($h_C_HijackHandle), "DarkMode_Explorer")
		_WinAPI_SetWindowTheme(GUICtrlGetHandle($h_C_CloakThread), "DarkMode_Explorer")
		_WinAPI_SetWindowTheme(GUICtrlGetHandle($h_C_Unlink), "Explorer")
		_WinAPI_SetWindowTheme(GUICtrlGetHandle($h_C_LoadCopy), "Explorer")
		_WinAPI_SetWindowTheme(GUICtrlGetHandle($h_C_ProcName), "Explorer")
		_WinAPI_SetWindowTheme(GUICtrlGetHandle($h_C_Method), "Explorer")
		_WinAPI_SetWindowTheme(GUICtrlGetHandle($h_C_LaunchMethod), "Explorer")
		_WinAPI_SetWindowTheme(GUICtrlGetHandle($h_C_Header), "Explorer")

		_WinAPI_SetWindowTheme(GUICtrlGetHandle($h_C_RandomizeName), "Explorer")
		_WinAPI_SetWindowTheme(GUICtrlGetHandle($h_C_Shift), "Explorer")
		_WinAPI_SetWindowTheme(GUICtrlGetHandle($h_C_Clean), "Explorer")

		GUICtrlSetColor($h_B_SwitchTheme, $C_GUI_Text[1])
		GUICtrlSetBkColor($h_B_SwitchTheme, $C_GUI_Ctrl_Button[1])
		GUICtrlSetData($h_B_SwitchTheme, "Dark mode")
	EndIf

	GUISetBkColor($C_GUI[$g_DarkThemeEnabled], $h_GUI)

	GUICtrlSetBkColor	($h_L_ProcName, $C_GUI_Ctrl_Label[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_L_ProcName, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_L_PID, $C_GUI_Ctrl_Label[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_L_PID, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_L_InjDelay, $C_GUI_Ctrl_Label[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_L_InjDelay, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_L_Version, $C_GUI_Version_Label[$g_DarkThemeEnabled])


	GUICtrlSetBkColor	($h_B_Settings[5], $C_GUI_Ctrl_Label[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_B_Settings[5], $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_B_InjectionMethod[5], $C_GUI_Ctrl_Label[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_B_InjectionMethod[5], $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_B_Cloaking[5], $C_GUI_Ctrl_Label[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_B_Cloaking[5], $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_B_Files[5], $C_GUI_Ctrl_Label[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_B_Files[5], $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_B_Info[5], $C_GUI_Ctrl_Label[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_B_Info[5], $C_GUI_Text[$g_DarkThemeEnabled])

	For $i = 0 To 4 Step 1
		GUICtrlSetBkColor	($h_B_Settings[$i], $C_GUI_Border[$g_DarkThemeEnabled])
		GUICtrlSetColor		($h_B_Settings[$i], $C_GUI_Border[$g_DarkThemeEnabled])

		GUICtrlSetBkColor	($h_B_InjectionMethod[$i], $C_GUI_Border[$g_DarkThemeEnabled])
		GUICtrlSetColor		($h_B_InjectionMethod[$i], $C_GUI_Border[$g_DarkThemeEnabled])

		GUICtrlSetBkColor	($h_B_Cloaking[$i], $C_GUI_Border[$g_DarkThemeEnabled])
		GUICtrlSetColor		($h_B_Cloaking[$i], $C_GUI_Border[$g_DarkThemeEnabled])

		GUICtrlSetBkColor	($h_B_Files[$i], $C_GUI_Border[$g_DarkThemeEnabled])
		GUICtrlSetColor		($h_B_Files[$i], $C_GUI_Border[$g_DarkThemeEnabled])

		GUICtrlSetBkColor	($h_B_Info[$i], $C_GUI_Border[$g_DarkThemeEnabled])
		GUICtrlSetColor		($h_B_Info[$i], $C_GUI_Border[$g_DarkThemeEnabled])
	Next


	GUICtrlSetBkColor	($h_C_CloseAI, $C_GUI_Ctrl_Checkbox[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_C_CloseAI, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_C_AutoI, $C_GUI_Ctrl_Checkbox[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_C_AutoI, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_C_HijackHandle, $C_GUI_Ctrl_Checkbox[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_C_HijackHandle, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_C_CloakThread, $C_GUI_Ctrl_Checkbox[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_C_CloakThread, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_C_Unlink, $C_GUI_Ctrl_Checkbox[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_C_Unlink, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_C_LoadCopy, $C_GUI_Ctrl_Checkbox[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_C_LoadCopy, $C_GUI_Text[$g_DarkThemeEnabled])


	GUICtrlSetBkColor	($h_C_ProcName, $C_GUI_Ctrl_Combo[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_C_ProcName, $C_GUI_Text[$g_DarkThemeEnabled])
	_GUICtrlComboBox_SetEditSel($h_C_ProcName, 0, 0)

	GUICtrlSetBkColor	($h_C_Method, $C_GUI_Ctrl_Combo[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_C_Method, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_C_LaunchMethod, $C_GUI_Ctrl_Combo[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_C_LaunchMethod, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_C_Header, $C_GUI[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_C_Header, $C_GUI_Text[$g_DarkThemeEnabled])


	GUICtrlSetBkColor	($h_B_SelProcess, $C_GUI_Ctrl_Button[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_B_SelProcess, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_B_AdvSettings, $C_GUI_Ctrl_Button[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_B_AdvSettings, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_B_Reset, $C_GUI_Ctrl_Button[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_B_Reset, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_B_Add, $C_GUI_Ctrl_Button[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_B_Add, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_B_Inject, $C_GUI_Ctrl_Button[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_B_Inject, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_B_Remove, $C_GUI_Ctrl_Button[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_B_Remove, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_B_ToggleTips, $C_GUI_Ctrl_Button[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_B_ToggleTips, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_B_Help, $C_GUI_Ctrl_Button[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_B_Help, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_B_Changelog, $C_GUI_Ctrl_Button[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_B_Changelog, $C_GUI_Text[$g_DarkThemeEnabled])


	GUICtrlSetBkColor	($h_R_ProcName, $C_GUI_Ctrl_Radio[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_R_ProcName, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_R_PID, $C_GUI_Ctrl_Radio[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_R_PID, $C_GUI_Text[$g_DarkThemeEnabled])


	GUICtrlSetBkColor	($h_I_InjDelay, $C_GUI_Ctrl_Input[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_I_InjDelay, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_I_PID, $C_GUI_Ctrl_Input[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_I_PID, $C_GUI_Text[$g_DarkThemeEnabled])


	_GUICtrlListView_BeginUpdate($g_hDllList)
	GUICtrlSetBkColor	($g_hDllList, $C_GUI_Ctrl_Listview[$g_DarkThemeEnabled])
	GUICtrlSetColor		($g_hDllList, $C_GUI_Text[$g_DarkThemeEnabled])
	_GUICtrlListView_EndUpdate($g_hDllList)
	_GUICtrlListView_RedrawItems($g_hDllList, 0, _GUICtrlListView_GetItemCount($g_hDllList) - 1)


	GUISetBkColor($C_GUI[$g_DarkThemeEnabled], $h_G_AdvSettings)

	GUICtrlSetBkColor	($h_C_RandomizeName, $C_GUI_Ctrl_Checkbox[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_C_RandomizeName, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_C_Shift, $C_GUI_Ctrl_Checkbox[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_C_Shift, $C_GUI_Text[$g_DarkThemeEnabled])

	GUICtrlSetBkColor	($h_C_Clean, $C_GUI_Ctrl_Checkbox[$g_DarkThemeEnabled])
	GUICtrlSetColor		($h_C_Clean, $C_GUI_Text[$g_DarkThemeEnabled])


	GUISetState(@SW_UNLOCK, $h_GUI)

	UpdateProcessIcon($g_PID)

EndFunc   ;==>UpdateTheme

Func GetStringDimensions($hWnd, $Text)

	If (NOT IsHWnd($hWnd)) Then $hWnd = GUICtrlGetHandle($hWnd)

    Local $hDC 		= _WinAPI_GetDC($hWnd)
    Local $hFont 	= _SendMessage($hWnd, $WM_GETFONT)

    Local $hSelectObject 	= _WinAPI_SelectObject($hDC, $hFont)
    Local $tSIZE 			= _WinAPI_GetTextExtentPoint32($hDC, $Text)

    _WinAPI_SelectObject($hDC, $hSelectObject)
    _WinAPI_ReleaseDC($hWnd, $hDC)

    Return $tSIZE

EndFunc   ;==>GetStringDimensions

Func CreateGroupBoxNoText($x, $y, $w, $h, $BorderColour)

	Local $Ret[4] = [0, 0, 0, 0]

	$Ret[0] 	= GUICtrlCreateLabel("", $x, $y, $w, 1)
	GUICtrlSetBkColor(-1, $BorderColour)

	$Ret[1] 	= GUICtrlCreateLabel("", $x, $y, 1, $h)
	GUICtrlSetBkColor(-1, $BorderColour)

	$Ret[2] 	= GUICtrlCreateLabel("", $x + $w, $y, 1, $h)
	GUICtrlSetBkColor(-1, $BorderColour)

	$Ret[3]		= GUICtrlCreateLabel("", $x, $y + $h, $w + 1, 1)
	GUICtrlSetBkColor(-1, $BorderColour)

	Return $Ret

EndFunc   ;==>CreateGroupBoxNoText

Func CreateGroupBox($hOwner, $Title, $x, $y, $w, $h, $BorderColour = 0xFF000000, $TextStyle = $SS_CENTER, $TextColour = 0xFF000000, $TextOffset = 5)

	$hDummyLabel = GUICtrlCreateLabel($Title, 600, 600)
	$TextRect = GetStringDimensions(GUICtrlGetHandle($hDummyLabel), $Title)
	GUICtrlDelete($hDummyLabel)

	If (BitAND($TextStyle, $SS_CENTER) <> 0) Then
		$TextOffset = ($w - $TextRect.X) / 2
	ElseIf (BitAND($TextStyle, $SS_RIGHT) <> 0) Then
		$TextOffset = $w - $TextRect.X - $TextOffset
	EndIf

	Local $Ret[6]

	$Ret[0]	= GUICtrlCreateLabel("", $x, $y, $TextOffset, 1)
	GUICtrlSetBkColor(-1, $BorderColour)

	$Ret[1]	= GUICtrlCreateLabel("", $x + $TextOffset + $TextRect.X, $y, $w - $TextOffset - $TextRect.X, 1)
	GUICtrlSetBkColor(-1, $BorderColour)

	$Ret[2]	= GUICtrlCreateLabel("", $x, $y, 1, $h)
	GUICtrlSetBkColor(-1, $BorderColour)

	$Ret[3]	= GUICtrlCreateLabel("", $x + $w - 1, $y, 1, $h)
	GUICtrlSetBkColor(-1, $BorderColour)

	$Ret[4]	= GUICtrlCreateLabel("", $x, $y + $h - 1, $w, 1)
	GUICtrlSetBkColor(-1, $BorderColour)

	$Ret[5]	= GUICtrlCreateLabel($Title, $x + $TextOffset, $y - $TextRect.Y / 2, $TextRect.X, $TextRect.Y)
	GUICtrlSetColor(-1, $TextColour)

	Return $Ret

EndFunc   ;==>CreateGroupBox

Func CreateBitmapFromIcon($BackgroundColour, $FilePath, $IconIndex, $Size)

    $hDC = _WinAPI_GetDC(0)
    $hBackDC = _WinAPI_CreateCompatibleDC($hDC)
    $hBitmap = _WinAPI_CreateSolidBitmap(0, $BackgroundColour, $Size, $Size)
    $hBackSv = _WinAPI_SelectObject($hBackDC, $hBitmap)
    $hIcon = _WinAPI_ExtractIcon($FilePath, $IconIndex, True)

    If (NOT @error) Then
        _WinAPI_DrawIconEx($hBackDC, 0, 0, $hIcon, 0, 0, 0, 0, $DI_NORMAL)
        _WinAPI_DestroyIcon($hIcon)
	EndIf

    _WinAPI_SelectObject($hBackDC, $hBackSv)
    _WinAPI_ReleaseDC(0, $hDC)
    _WinAPI_DeleteDC($hBackDC)

    Return $hBitmap

EndFunc   ;==>CreateBitmapFromIcon

Func DllList_PopUp($hwnd)

	Local $ItemHit = _GUICtrlListView_HitTest($hwnd)

	If (UBound($ItemHit) AND $ItemHit[0] <> -1) Then
		$popup_action_id = _PopUpMenu_Track($h_PM_DllList_Sel[$g_DarkThemeEnabled])
		If ($popup_action_id[0]) Then
			UpdateLV($g_hDllList, $popup_action_id[1], $M_Selected)
		EndIf
	Else
		$popup_action_id = _PopUpMenu_Track($h_PM_DllList_All[$g_DarkThemeEnabled])
		If ($popup_action_id[0]) Then
			UpdateLV($g_hDllList, $popup_action_id[1], $M_All)
		EndIf
	EndIf

EndFunc   ;==>DllList_PopUp

Func UpdateLV($hListView, $ActionID, $Mode = $M_All)

	$Count 		= _GUICtrlListView_GetItemCount($hListView)
	$SelIndices = _GUICtrlListView_GetSelectedIndices($hListView, True)

	If ($Mode = $M_Selected AND (NOT IsArray($SelIndices) OR $SelIndices[0] = 0)) Then
		Return
	EndIf

	_GUICtrlListView_BeginUpdate($hListView)

	Switch $Mode
		Case $M_Selected
			Switch $ActionID
				Case $A_ID_Toggle
					For $i = 1 To $SelIndices[0] Step 1
						$checked = _GUICtrlListView_GetItemChecked($hListView, $SelIndices[$i])
						If ($checked = True) Then
							_GUICtrlListView_SetItemChecked($hListView, $SelIndices[$i], False)
						Else
							_GUICtrlListView_SetItemChecked($hListView, $SelIndices[$i], True)
						EndIf
					Next

				Case $A_ID_Activate
					For $i = 1 To $SelIndices[0] Step 1
						_GUICtrlListView_SetItemChecked($hListView, $SelIndices[$i], True)
					Next

				Case $A_ID_Deactivate
					For $i = 1 To $SelIndices[0] Step 1
						_GUICtrlListView_SetItemChecked($hListView, $SelIndices[$i], False)
					Next

				Case $A_ID_Select
					_GUICtrlListView_SetItemSelected($hListView, -1)

				Case $A_ID_Delete
					For $i = $SelIndices[0] To 1 Step -1
						_GUICtrlListView_DeleteItem($hListView, $SelIndices[$i])
					Next

				Case $A_ID_Open
					$filepath = _GUICtrlListView_GetItemText($hListView, $SelIndices[1], 2)
					If (IsString($filepath)) Then
						$pos 		= StringInStr($filepath, "\", $STR_NOCASESENSE, -1)
						$filepath 	= StringTrimRight($filepath, StringLen($filepath) - $pos + 1)
						ShellExecute($filepath)
					EndIf

			EndSwitch
		Case $M_All
			Switch $ActionID
				Case $A_ID_ToggleAll
					For $i = 0 To $Count - 1 Step 1
						$checked = _GUICtrlListView_GetItemChecked($hListView, $i)
						If ($checked = True) Then
							_GUICtrlListView_SetItemChecked($hListView, $i, False)
						Else
							_GUICtrlListView_SetItemChecked($hListView, $i, True)
						EndIf
					Next

				Case $A_ID_ActivateAll
					_GUICtrlListView_SetItemChecked($hListView, -1, True)

				Case $A_ID_DeactivateAll
					_GUICtrlListView_SetItemChecked($hListView, -1, False)

				Case $A_ID_SelectAll
					_GUICtrlListView_SetItemSelected($hListView, -1)

				Case $A_ID_DeleteAll
					_GUICtrlListView_DeleteAllItems($hListView)

				Case $A_ID_DeleteInvalid
					Local $filepath_list[$Count]

					For $i = $Count - 1 To 0 Step -1
						$filepath = _GUICtrlListView_GetItemText($hListView, $i, 2)
						If (NOT FileExists($filepath)) Then
							_GUICtrlListView_DeleteItem($hListView, $i)
						EndIf
					Next

			EndSwitch
	EndSwitch

	_GUICtrlListView_EndUpdate($hListView)

EndFunc   ;==>UpdateLV

Func GUI_LV_SubclassProc($hWnd, $uMsg, $wParam, $lParam, $iID, $pData)

	If ($uMsg = $WM_GETDLGCODE) Then
		If ($wParam = $VK_DELETE) Then
			$tMsg = DllStructCreate($_tagMSG, $lParam)
			If ($tMsg.message = $WM_KEYDOWN) Then
				UpdateLV($g_hDllList, $A_ID_Delete, $M_Selected)
			EndIf
		ElseIf ($wParam = $VK_SPACE) Then
			$tMsg = DllStructCreate($_tagMSG, $lParam)
			If ($tMsg.message = $WM_KEYDOWN AND NOT BitAND($tMsg.lParam, 0x40000000)) Then
				UpdateLV($g_hDllList, $A_ID_Activate, $M_Selected)
			EndIf
		EndIf
	ElseIf ($g_DarkThemeEnabled AND $uMsg = $WM_NOTIFY) Then
		$tNMHDR = DllStructCreate($tagNMHDR, $lParam)
		If ($tNMHDR.Code = $NM_CUSTOMDRAW AND $tNMHDR.hWndFrom = $g_h_DllListHeader) Then
			Local $NMLVCD = DllStructCreate($tagNMLVCUSTOMDRAW, $lParam)

			Switch $NMLVCD.dwDrawStage
				Case $CDDS_PREPAINT
					Return $CDRF_NOTIFYITEMDRAW

				Case $CDDS_ITEMPREPAINT
					Return $CDRF_NOTIFYPOSTPAINT

				Case $CDDS_ITEMPOSTPAINT

					Local $hDC 		= $NMLVCD.hdc
					Local $index 	= $NMLVCD.dwItemSpec

					If ($index < 0 OR $index > UBound($g_DllList_ColumnWidth) - 1 OR ($g_DllList_ColumnWidth[$index] = 0)) Then
						Return $CDRF_DODEFAULT
					EndIf

					_WinAPI_SelectObject($hDC, $G_HFONT_LV_Font)
					_WinAPI_SetBkMode($hDC, $TRANSPARENT)
					_WinAPI_SetTextColor($hDC, $C_GUI_Text[1])

					$curr_total_col_width = 0
					For $i = 0 To $index - 1 Step 1
						$curr_total_col_width += $g_DllList_ColumnWidth[$i]
					Next

					$GUI_RECT_Buffer.Left 	= $NMLVCD.Left
					$GUI_RECT_Buffer.Top 	= $NMLVCD.Top
					$GUI_RECT_Buffer.Right 	= $NMLVCD.Right
					$GUI_RECT_Buffer.Bottom = $NMLVCD.Bottom

					If ($NMLVCD.uItemState = $CDIS_SELECTED) Then
						_WinAPI_FillRect($hDC, $GUI_RECT_Buffer, $G_HBRUSH_Light)
						If (BitAND($g_DllList_HoverHeader, 2 ^ $index)) Then
							$g_DllList_HoverHeader = 0
						EndIf
					Else
						Local $info = MouseGetPos()
						$info[0] -= $g_LV_XY[0] + $g_MainGUI_X
						$info[1] -= $g_LV_XY[1] + $g_MainGUI_Y

						If ($info[0] >= $GUI_RECT_Buffer.Left AND $info[0] <= $GUI_RECT_Buffer.Right AND $info[1] >= $GUI_RECT_Buffer.Top AND $info[1] <= $GUI_RECT_Buffer.Bottom) Then
							_WinAPI_FillRect($hDC, $GUI_RECT_Buffer, $G_HBRUSH_SemiDark)
							$g_DllList_HoverHeader = BitOR($g_DllList_HoverHeader, 2 ^ $index)
						Else
							_WinAPI_FillRect($hDC, $GUI_RECT_Buffer, $G_HBRUSH_Dark)
							If (BitAND($g_DllList_HoverHeader, 2 ^ $index)) Then
								$g_DllList_HoverHeader = 0
							EndIf
						EndIf
					EndIf

					If ($index > 0 AND $index < UBound($g_DllList_ColumnWidth) - 1) Then
						$GUI_RECT_Buffer.Right 	= $GUI_RECT_Buffer.Left + 2
						$GUI_RECT_Buffer.Top 	+= 2
						$GUI_RECT_Buffer.Bottom	-= 2
						_WinAPI_FillRect($hDC, $GUI_RECT_Buffer, $G_HBRUSH_SuperDark)
					EndIf

					If ($index > 0) Then
						$GUI_RECT_Buffer.Left	= $curr_total_col_width
						$GUI_RECT_Buffer.Right 	= $g_DllList_ColumnWidth[$index] + $curr_total_col_width
						$GUI_RECT_Buffer.Top 	= $NMLVCD.Top + 4
						$GUI_RECT_Buffer.Bottom = $NMLVCD.Bottom

						_WinAPI_DrawText($hDC, "  " & $g_LV_HeaderTextSplit[$index], $GUI_RECT_Buffer, $DT_VCENTER)
					EndIf

					Return $CDRF_NEWFONT
				EndSwitch
		EndIf
	EndIf

	Return DllCall($h_Comctl32_DLL, "LRESULT", "DefSubclassProc", "HWND", $hWnd, "UINT", $uMsg, "WPARAM", $wParam, "LPARAM", $lParam)[0]

EndFunc   ;==>LV_SubClassProc

Func GUI_WM_NOTIFY($hWnd, $uMsg, $wParam, $lParam)

	$tNMHDR = DllStructCreate($tagNMHDR, $lParam)

	$hListView = GUICtrlGetHandle($g_hDllList)
	If (HWnd($tNMHDR.hwndFrom) = $hListView) Then
		If ($tNMHDR.code = $NM_RCLICK) Then
			DllList_PopUp($hListView)

		ElseIf ($tNMHDR.code = $NM_CUSTOMDRAW) Then
		    If (_GUICtrlListView_GetColumnWidth($g_hDllList, 0) <> $g_DllList_ColumnWidth[0]) Then
				_GUICtrlListView_SetColumnWidth($g_hDllList, 0, $g_DllList_ColumnWidth[0])
		    EndIf

			If (_GUICtrlListView_GetColumnWidth($g_hDllList, 4) <> $g_DllList_ColumnWidth[4]) Then
				_GUICtrlListView_SetColumnWidth($g_hDllList, 4, $g_DllList_ColumnWidth[4])
			EndIf

			$col_width_sum = 0
			For $i = 0 To 4 Step 1
				$g_DllList_ColumnWidth[$i] = _GUICtrlListView_GetColumnWidth($g_hDllList, $i)
				$col_width_sum += $g_DllList_ColumnWidth[$i]
			Next

			If ($col_width_sum < $l_DllListWidth) Then
				_GUICtrlListView_SetColumnWidth($g_hDllList, 3, $g_DllList_ColumnWidth[3] + $l_DllListWidth - $col_width_sum)
			EndIf

		ElseIf ($tNMHDR.code = $NM_DBLCLK) Then
			$tInfo = DllStructCreate($tagNMITEMACTIVATE, $lParam)
			If ($tInfo.SubItem > 0) Then
				$l_DoubleClickedDll = $tInfo.Index
			EndIf
		EndIf
	EndIf

    Return $GUI_RUNDEFMSG

EndFunc   ;==>GUI_WM_NOTIFY

Func WM_CTLCOLORLISTBOX($hWnd, $uMsg, $wParam, $lParam)

	If $g_DarkThemeEnabled Then
		_WinAPI_SetTextColor($wParam, $C_GUI_Text[1])
		Return $G_HBRUSH_Dark
	EndIf

    Return $GUI_RUNDEFMSG

EndFunc   ;==>WM_CTLCOLORLISTBOX

Func WM_NOTIFY($hWnd, $uMsg, $wParam, $lParam)

	If (NOT $l_ProcessListActive) Then
		Return GUI_WM_NOTIFY($hWnd, $uMsg, $wParam, $lParam)
	Else
		Return PL_WM_NOTIFY($hWnd, $uMsg, $wParam, $lParam)
	EndIf

EndFunc   ;==>WM_NOTFIY

Func WM_DROPFILES($hWnd, $uMsg, $wParam, $lParam)

    Local $Ret = _WinAPI_DragQueryFileEx($wParam, 1)
	If (UBound($Ret)) Then
		$DropFileBuffer = $Ret
	Else
		$DropFileBuffer[0] = 0
	EndIf

    Return $GUI_RUNDEFMSG

EndFunc   ;==>WM_DROPFILES

Func WM_COMMAND($hWnd, $uMsg, $wParam, $lParam)

	If ($l_IgnoreInputChange = True) Then
		Return $GUI_RUNDEFMSG
	EndIf

    Local $NotifyCode = _WinAPI_HiWord($wParam)

    If ($NotifyCode = $CBN_EDITUPDATE) Then

		If (_WinAPI_LoWord($wParam) = $h_C_ProcName) Then
			$g_Processname = GUICtrlRead($h_C_ProcName)

			$hWnd_Combo = GUICtrlGetHandle($h_C_ProcName)

			If (BitAND(DllCall($h_User32_dll, "SHORT", "GetAsyncKeyState", "int", $VK_BACK)[0], 0x8000) OR _
				BitAND(DllCall($h_User32_dll, "SHORT", "GetAsyncKeyState", "int", $VK_DELETE)[0], 0x8000)) Then
				Return $GUI_RUNDEFMSG
			EndIf

			$sEditText = _GUICtrlComboBox_GetEditText($hWnd_Combo)
			If (StringLen($sEditText) <> 0) Then
				Local $iRet = _GUICtrlComboBox_FindString($hWnd_Combo, $sEditText)
				If ($iRet <> $CB_ERR) Then
					Local $sInputText = 0
					_GUICtrlComboBox_GetLBText($hWnd_Combo, $iRet, $sInputText)
					_GUICtrlComboBox_SetEditText($hWnd_Combo, $sInputText)
					_GUICtrlComboBox_SetEditSel($hWnd_Combo, StringLen($sEditText), StringLen($sInputText))
				EndIf
				$l_AutoComplete = True
			Else
				$l_AutoComplete = False
			EndIf

			$l_UpdateProcess = True
		EndIf

	ElseIf ($NotifyCode = $CBN_CLOSEUP) Then

		If (_WinAPI_LoWord($wParam) = $h_C_ProcName) Then
			$g_Processname = GUICtrlRead($h_C_ProcName)
			$l_UpdateProcess = True
		EndIf

	ElseIf ($NotifyCode = $EN_CHANGE) Then

		Local $NotifierID = _WinAPI_LoWord($wParam)

		If ($NotifierID = $h_I_PID) Then
			$g_PID = GUICtrlRead($h_I_PID)
			$l_UpdateProcess = True
		ElseIf ($NotifierID = $h_I_InjDelay) Then
			$g_InjectionDelay = GUICtrlRead($h_I_InjDelay)
		EndIf

	EndIf

    Return $GUI_RUNDEFMSG

EndFunc   ;==>WM_COMMAND

Func WM_MOVE($hWnd, $uMsg, $wParam, $lParam)

	If ($hWnd = $h_GUI) Then
		$g_MainGUI_X = MakeShort(BitAND($lParam, 0xFFFF), $g_ShortStruct)
		$g_MainGUI_Y = MakeShort(BitAND(BitShift($lParam, 0x10), 0xFFFF), $g_ShortStruct)
	ElseIf ($l_ProcessListActive) Then
		$PL_ProcessList_X = MakeShort(BitAND($lParam, 0xFFFF), $g_ShortStruct)
		$PL_ProcessList_Y = MakeShort(BitAND(BitShift($lParam, 0x10), 0xFFFF), $g_ShortStruct)
	EndIf

	Return $GUI_RUNDEFMSG

EndFunc   ;==>WM_MOVE

Func WM_PAINT($hWnd, $uMsg, $wParam, $lParam)

	If ($hWnd = $h_GUI) Then
		UpdateProcessIcon($g_PID)
	EndIf

	Return $GUI_RUNDEFMSG

EndFunc   ;==>WM_PAINT

Func ResetGUI()

	GUICtrlSetState($h_R_ProcName, $GUI_CHECKED)
	GUICtrlSetState($h_C_ProcName, $GUI_ENABLE)
	GUICtrlSetState($h_I_PID, $GUI_DISABLE)

	_GUICtrlComboBox_ResetContent($h_C_ProcName)
	GUICtrlSetData($h_C_ProcName, $g_ProcessnameList, $g_Processname)
	GUICtrlSetData($h_I_PID, $g_PID)

	GUICtrlSetData($h_I_InjDelay, $g_InjectionDelay)

	If ($g_CloseAfterInjection) Then
		GUICtrlSetState($h_C_CloseAI, $GUI_CHECKED)
	Else
		GUICtrlSetState($h_C_CloseAI, $GUI_UNCHECKED)
	EndIf

	If ($g_AutoInjection) Then
		GUICtrlSetState($h_C_AutoI, $GUI_CHECKED)
	Else
		GUICtrlSetState($h_C_AutoI, $GUI_UNCHECKED)
	EndIf

	_GUICtrlComboBox_SetCurSel($h_C_Method, $g_InjectionMethod)

	If (BitAND($g_InjectionFlags, $INJ_HIJACK_HANDLE) AND $g_RunNative) Then
		GUICtrlSetState($h_C_HijackHandle, BitOR($GUI_CHECKED, $GUI_ENABLE))
	ElseIf (NOT $g_RunNative) Then
		GUICtrlSetState($h_C_HijackHandle, BitOR($GUI_UNCHECKED, $GUI_DISABLE))
		GUICtrlSetData($h_L_HijackHandle, $GUI_ENABLE)
	Else
		GUICtrlSetData($h_L_HijackHandle, $GUI_DISABLE)
		GUICtrlSetState($h_C_HijackHandle, BitOR($GUI_UNCHECKED, $GUI_ENABLE))
	EndIf

	_GUICtrlComboBox_SetCurSel($h_C_LaunchMethod, $g_LaunchMethod)

	If ($g_LaunchMethod = 0) Then
		GUICtrlSetState($h_L_CloakThread, $GUI_DISABLE)
		$state = 0
		If (BitAND($g_InjectionFlags, $INJ_THREAD_CREATE_CLOAKED)) Then
			$state = BitOR($GUI_CHECKED, $GUI_ENABLE)
		Else
			$state = BitOR($GUI_UNCHECKED, $GUI_ENABLE)
		EndIf
		GUICtrlSetState($h_C_CloakThread, $state)
	Else
		GUICtrlSetState($h_C_CloakThread, BitOR($GUI_UNCHECKED, $GUI_DISABLE))
		GUICtrlSetState($h_L_CloakThread, $GUI_ENABLE)
	EndIf

	_GUICtrlComboBox_SetCurSel($h_C_Header, 0)
	If (BitAND($g_InjectionFlags, $INJ_ERASE_HEADER)) Then
		_GUICtrlComboBox_SetCurSel($h_C_Header, 1)
	ElseIf (BitAND($g_InjectionFlags, $INJ_ERASE_HEADER)) Then
		_GUICtrlComboBox_SetCurSel($h_C_Header, 2)
	EndIf

	If($g_InjectionMethod = 2) Then
		GUICtrlSetState($h_C_Unlink, BitOR($GUI_CHECKED, $GUI_DISABLE))
		GUICtrlSetState($h_L_Unlink, $GUI_ENABLE)
	ElseIf (BitAND($g_InjectionFlags, $INJ_UNLINK_FROM_PEB)) Then
		GUICtrlSetState($h_L_Unlink, $GUI_DISABLE)
		GUICtrlSetState($h_C_Unlink, BitOR($GUI_CHECKED, $GUI_ENABLE))
	Else
		GUICtrlSetState($h_L_Unlink, $GUI_DISABLE)
		GUICtrlSetState($h_C_Unlink, BitOR($GUI_UNCHECKED, $GUI_ENABLE))
	EndIf

	If ($g_InjectionMethod <> 2) Then
		GUICtrlSetState($h_C_Shift, BitOR($GUI_UNCHECKED, $GUI_DISABLE))
		GUICtrlSetState($h_C_Clean, BitOR($GUI_UNCHECKED, $GUI_DISABLE))

		GUICtrlSetState($h_L_Shift, $GUI_ENABLE)
		GUICtrlSetState($h_L_Clean, $GUI_ENABLE)
	Else
		GUICtrlSetState($h_L_Shift, $GUI_DISABLE)
		$state = 0
		If (BitAND($g_InjectionFlags, $INJ_SHIFT_MODULE)) Then
			$state = BitOR($GUI_CHECKED, $GUI_ENABLE)
		Else
			$state = BitOR($GUI_CHECKED, $GUI_DISABLE)
		EndIf
		GUICtrlSetState($h_C_Shift, $state)

		GUICtrlSetState($h_L_Clean, $GUI_DISABLE)
		$state = 0
		If (BitAND($g_InjectionFlags, $INJ_SHIFT_MODULE)) Then
			$state = BitOR($GUI_CHECKED, $GUI_ENABLE)
		Else
			$state = BitOR($GUI_CHECKED, $GUI_DISABLE)
		EndIf
		GUICtrlSetState($h_C_Clean, $state)
	EndIf

	If (BitAND($g_InjectionFlags, $INJ_SCRAMBLE_DLL_NAME)) Then
		GUICtrlSetState($h_C_RandomizeName, $GUI_CHECKED)
	Else
		GUICtrlSetState($h_C_RandomizeName, $GUI_UNCHECKED)
	EndIf

	If (BitAND($g_InjectionFlags, $INJ_LOAD_DLL_COPY)) Then
		GUICtrlSetState($h_C_LoadCopy, $GUI_CHECKED)
	Else
		GUICtrlSetState($h_C_LoadCopy, $GUI_UNCHECKED)
	EndIf

	If ($g_ToolTipsOn = False) Then
		_GUIToolTip_Deactivate($h_T_TooltipCtrl)
		GUICtrlSetData($h_B_ToggleTips, "Enable Tooltips")
	Else
		_GUIToolTip_Activate($h_T_TooltipCtrl)
		GUICtrlSetData($h_B_ToggleTips, "Disable Tooltips")
	EndIf

	UpdateTheme($g_DarkThemeEnabled)

EndFunc   ;==>ResetGUI

Func CloseGUI()

	GUIRegisterMsg($WM_NOTIFY,			"")
	GUIRegisterMsg($WM_DROPFILES, 		"")
	GUIRegisterMsg($WM_COMMAND, 		"")
	GUIRegisterMsg($WM_MOVE,			"")
	GUIRegisterMsg($WM_PAINT,			"")
	GUIRegisterMsg($WM_CTLCOLORLISTBOX, "")

	_WinAPI_DeleteObject($G_HBRUSH_Light)
	_WinAPI_DeleteObject($G_HBRUSH_SemiDark)
	_WinAPI_DeleteObject($G_HBRUSH_Dark)
	_WinAPI_DeleteObject($G_HBRUSH_SuperDark)
	_WinAPI_DeleteObject($G_HFONT_LV_Font)

    _WinAPI_RemoveWindowSubclass(GUICtrlGetHandle($g_hDllList), $ph_GUI_LV_SubclassProc, 1)
	DllCallbackFree($h_GUI_LV_SubclassProc)

	DllClose($h_Comctl32_DLL)
	DllClose($h_User32_dll)
	DllClose($g_kernel32_dll)

	_GUIImageList_Destroy($h_P_ProcIcon)

	_PopUpMenu_Delete($h_PM_DllList_Sel[1])
	_PopUpMenu_Delete($h_PM_DllList_Sel[0])
	_PopUpMenu_Delete($h_PM_DllList_All[1])
	_PopUpMenu_Delete($h_PM_DllList_All[0])

	GUISetState(@SW_HIDE)

	GUIDelete($h_G_AdvSettings)
	GUIDelete($h_GUI)

EndFunc   ;==>CloseGUI

Func UpdateCursor()

	Local $CursorInfo = GUIGetCursorInfo($h_GUI)

	If (NOT @error) Then
		If (WinActive($h_GUI) AND $CursorInfo[0] >= 130 AND $CursorInfo[0] <= 151 AND $CursorInfo[1] >= 132 AND $CursorInfo[1] <= 152) Then
			$l_HoverProcIcon = True
		Else
			$l_HoverProcIcon = False
		EndIf
	EndIf

	If ($l_HoverProcIcon <> $l_HoverProcIconPrev) Then
		If ($l_HoverProcIcon = True) Then
			Local $CursorPos = MouseGetPos()
			ToolTip($g_ExePath, $CursorPos[0], $CursorPos[1])
		Else
			ToolTip("")
		EndIf
		$l_HoverProcIconPrev = $l_HoverProcIcon
	EndIf

EndFunc   ;==>UpdateCursor

Func AddFile($Path, $UpdateLastDirectory = False)

	If (NOT StringInStr($Path, ".dll") AND NOT StringInStr($Path, ".exe")) Then
		Return
	EndIf

	$DllCount = _GUICtrlListView_GetItemCount($g_hDllList)
	For $i = 0 To $DllCount Step 1
		$currPath = _GUICtrlListView_GetItemText($g_hDllList, $i, 2)
		If (NOT StringCompare($Path, $currPath)) Then
			MsgBox($MB_ICONERROR, $Path, "This file is already in the list.")
			Return
		EndIf
	Next

	SetError(0)
	$Architecture = GetFileArchitecture($Path)
	If (@error) Then
		$err = @error
		SetError(0)

		Switch $err
			Case 1
				MsgBox($MB_ICONERROR, "Invalid MZ header: 0x" & Hex($Architecture), $Path)
				Return

			Case 2
				MsgBox($MB_ICONERROR, "Invalid PE signature: 0x" & Hex($Architecture), $Path)
				Return

			Case 3
				MsgBox($MB_ICONERROR, "Architecture not supported: 0x" & Hex($Architecture), $Path)
				Return
		EndSwitch
	EndIf

	Local $Split = StringSplit($Path, "\")
	$Index = _GUICtrlListView_AddItem($g_hDllList, "")
	_GUICtrlListView_AddSubItem($g_hDllList, $Index, $Split[$Split[0]], 1)
	_GUICtrlListView_AddSubItem($g_hDllList, $Index, $Path, 2)
	_GUICtrlListView_AddSubItem($g_hDllList, $Index, $Architecture, 3)
	_GUICtrlListView_AddSubItem($g_hDllList, $Index, 0, 4)

	If ($UpdateLastDirectory = True) Then
		$g_LastDirectory = ""
		For $i = 0 To $Split[0] - 2 Step 1
			$g_LastDirectory = $g_LastDirectory & $Split[$i + 1] & "\"
		Next
	EndIf

EndFunc   ;==>AddFile

Func AddFiles($Path = 0)

	If (NOT IsString($Path)) Then
		$Path = $g_LastDirectory
	EndIf

	$Files = FileOpenDialog("Select dll files", $Path, "Dynamic Link Libraries (*.dll)", $FD_MULTISELECT, '', $h_GUI)
	If (@error) Then
		Return
	EndIf

	$g_LastDirectory = @WorkingDir

	Local $Chars = StringSplit($Files, "|")
	If (@error = 1) Then
		AddFile($Files, True)
		Return
	EndIf

	_GUICtrlListView_BeginUpdate($g_hDllList)

	For $i = 2 To $Chars[0] Step 1
		AddFile($Chars[1] & "\" & $Chars[$i])
	Next

	_GUICtrlListView_EndUpdate($g_hDllList)

EndFunc   ;==>AddFiles

Func UpdateProcessIcon($TargetPID)

    _GUIImageList_Draw($h_P_ProcIcon, $g_DarkThemeEnabled, _WinAPI_GetDC($h_GUI), 132, 132)

	If (NOT StringCompare($g_Processname, "Broihon.exe") OR $g_PID = 1337) Then
	    _GUIImageList_Draw($h_P_ProcIcon, $g_PI_INDEX_LUL, _WinAPI_GetDC($h_GUI), 132, 132)
		$g_ExePath = "Praise Broihon "
	    Return
    EndIf

	If ($TargetPID <> -1) Then
		$hProc_info = DllCall($g_kernel32_dll, "HANDLE", "OpenProcess", _
			"DWORD", $PROCESS_QUERY_LIMITED_INFORMATION, _
			"INT", 0, _
			"DWORD", $TargetPID _
		)

		If (IsArray($hProc_info) AND $hProc_info[0]) Then

			Local $dllRet = GetProcessExePath($hProc_info)
			If (IsArray($dllRet) AND ($dllRet[0] <> 0)) Then
				$l_ProcIconIndex = $g_PI_INDEX_Valid
				_GUIImageList_Remove($h_P_ProcIcon, $g_PI_INDEX_Valid)
				$g_ExePath = $dllRet[3] & " (" & $l_TargetProcessArchitecture & ")"
				If (_GUIImageList_AddIcon($h_P_ProcIcon, $dllRet[3], 0, True) = -1) Then
					$l_ProcIconIndex = $g_PI_INDEX_Invalid
				EndIf
			Else
				$l_ProcIconIndex = $g_PI_INDEX_Inactive
				$g_ExePath = "Can't resolve file path."
			EndIf

			DllCall($g_kernel32_dll, "BOOL", "CloseHandle", _
				"HANDLE", $hProc_info[0] _
			)

		Else
			$l_ProcIconIndex = $g_PI_INDEX_Inactive
			$g_ExePath = "Can't resolve file path."
		EndIf

		If ($l_ProcIconIndex = $g_PI_INDEX_Invalid) Then
			Local $wnd_list = WinList()
			If (NOT @error) Then
				For $i = 1 To $wnd_list[0][0] Step 1
					If (WinGetProcess($wnd_list[$i][1]) = $g_PID) Then
						If (NOT StringCompare("ConsoleWindowClass", _WinAPI_GetClassName($wnd_list[$i][1]))) Then
							$l_ProcIconIndex = $g_PI_INDEX_Console
						EndIf
					EndIf
				Next
			EndIf
		EndIf

		_GUIImageList_Draw($h_P_ProcIcon, $l_ProcIconIndex, _WinAPI_GetDC($h_GUI), 132, 132)

	Else
		$g_ExePath = "No (active) process selected."
		_GUIImageList_Draw($h_P_ProcIcon, $g_PI_INDEX_Inactive, _WinAPI_GetDC($h_GUI), 132, 132)
	EndIf

EndFunc   ;==>UpdateProcessIcon

Func UpdateTargetProcess()

	$l_IgnoreInputChange = True

	$proc_alive = False

	If ($g_PID = 1337 AND NOT $g_ProcessByName) Then
		If (StringCompare($g_Processname, "Broihon.exe")) Then
			$g_Processname = "Broihon.exe"
			_GUICtrlComboBox_SetEditText($h_C_ProcName, $g_Processname)
		EndIf

	ElseIf (NOT StringCompare($g_Processname, "Broihon.exe") AND $g_ProcessByName) Then
		If ($g_PID <> 1337) Then
			$g_PID = 1337
			GUICtrlSetData($h_I_PID, $g_PID)
		EndIf

	ElseIf ($g_ProcessByName) Then
		$g_Processname = _GUICtrlComboBox_GetEditText($h_C_ProcName)
		$g_PID = ProcessExists($g_Processname)
		If ($g_PID <> 0) Then
			$index = _GUICtrlComboBox_FindString($h_C_ProcName, $g_Processname)
			If ($index = -1) Then
				_GUICtrlComboBox_AddString($h_C_ProcName, $g_Processname)
				$g_ProcessnameList = _GUICtrlComboBox_GetList($h_C_ProcName)
			EndIf
			$proc_alive = True
		EndIf
		GUICtrlSetData($h_I_PID, $g_PID)

	Else
		If (GUICtrlRead($h_I_PID) <> $g_PID) Then
			GUICtrlSetData($h_I_PID, $g_PID)
		EndIf

		$g_Processname = _ProcessGetName($g_PID)

		If (@error) Then
			$g_Processname = "Invalid PID"
			_GUICtrlComboBox_SetEditText($h_C_ProcName, $g_Processname)
		Else
			$proc_alive = True
			$index = _GUICtrlComboBox_FindString($h_C_ProcName, $g_Processname)
			If ($index = -1) Then
				$index = _GUICtrlComboBox_AddString($h_C_ProcName, $g_Processname)
				$g_ProcessnameList = _GUICtrlComboBox_GetList($h_C_ProcName)
			EndIf
			_GUICtrlComboBox_SetCurSel($h_C_ProcName, $index)
		EndIf
	EndIf

	$Arch = GetProcessArchitecture($g_PID)
	If (IsString($Arch)) Then
		$l_TargetProcessArchitecture = $Arch
	EndIf

	If ($proc_alive) Then
		UpdateProcessIcon($g_PID)
		$l_ProcessAlive = True
	Else
		UpdateProcessIcon(-1)
		$l_ProcessAlive = False
	EndIf

	$l_IgnoreInputChange = False

EndFunc   ;==>UpdateTargetProcess

Func CheckProcess()

	If ($g_PID = 1337 AND NOT $g_ProcessByName AND StringCompare($g_Processname, "Broihon.exe")) Then
		Return False
	EndIf

	If ($g_ProcessByName) Then
		If (NOT ProcessExists($g_Processname)) Then
			Return False
		EndIf
	ElseIf (NOT ProcessExists($g_PID)) Then
		Return False
	EndIf

	Return True

EndFunc   ;==>CheckProcess

Func UpdateGUI()

	If ($l_DoubleClickedDll <> -1) Then
		$filepath 	= _GUICtrlListView_GetItemText($g_hDllList, $l_DoubleClickedDll, 2)
		$pos 		= StringInStr($filepath, "\", $STR_NOCASESENSE, -1)
		$filepath 	= StringTrimRight($filepath, StringLen($filepath) - $pos + 1)
		AddFiles($filepath)
		$l_DoubleClickedDll = -1
	EndIf

	If ($l_AutoComplete AND BitAND(DllCall($h_User32_dll, "SHORT", "GetAsyncKeyState", "int", $VK_RETURN)[0], 0x8000)) Then
		$l_AutoComplete = False

		$l_IgnoreInputChange = True
		$sInputText = _GUICtrlComboBox_GetEditText($h_C_ProcName)
		_GUICtrlComboBox_SetEditText($h_C_ProcName, $sInputText)
		$l_IgnoreInputChange = False

		UpdateTargetProcess()
	EndIf

	$current_tick = GetTickCount()
	If ($current_tick - $last_tick_250 > 250) Then
		$b_check_process = CheckProcess()
		If (($b_check_process AND NOT $l_ProcessAlive) OR $l_UpdateProcess) Then
			UpdateTargetProcess()
			$l_UpdateProcess = False
		ElseIf (NOT $b_check_process AND $l_ProcessAlive) Then
			UpdateTargetProcess()
		EndIf

		UpdateCursor()

		$last_tick_250 = $current_tick
	EndIf

	$info = GUIGetCursorInfo($h_GUI)

	If ($info[4] = $g_hDllList) Then
		If ($info[1] - $g_LV_XY[1] < 23) Then
			$x_buffer 	= $g_LV_XY[0]
			$index 		= 0

			For $i = 0 To 3 Step 1
				If ($x_buffer > $info[0]) Then
					$index = $i
					ExitLoop
				EndIf
				$x_buffer += $g_DllList_ColumnWidth[$i]
			Next

			If ($index <> $g_LV_PrevHoverIndex) Then
				_WinAPI_RedrawWindow($g_h_DllListHeader)
				$g_LV_PrevHoverIndex = $index
			EndIf
		EndIf
	EndIf

	If ($info[4] = $h_B_Close) Then
		If ($info[2] AND NOT $b_ClickClose) Then
			$b_ClickClose = True
			GUICtrlSetColor($h_B_Close, 0xFFFFFF)
			GUICtrlSetBkColor($h_B_Close, 0xF1707A)

			While ($info[4] = $h_B_Close AND $info[2])
				$info = GUIGetCursorInfo($h_GUI)
				Sleep(10)
			WEnd

			If (NOT $info[2]) Then
				Return $GUI_EXIT
			Else
				$b_HoverClose = False
				$b_ClickClose = False
				GUICtrlSetColor($h_B_Close, 0xD0D0D0)
				GUICtrlSetBkColor($h_B_Close, 0x2D2D2D)
			EndIf
		ElseIf (NOT $b_HoverClose) Then
			$b_HoverClose = True
			$b_ClickClose = False
			GUICtrlSetColor($h_B_Close, 0xFFFFFF)
			GUICtrlSetBkColor($h_B_Close, 0xE81123)
		EndIf
	ElseIf ($b_HoverClose OR $b_ClickClose) Then
		$b_HoverClose = False
		$b_ClickClose = False
		GUICtrlSetColor($h_B_Close, 0xD0D0D0)
		GUICtrlSetBkColor($h_B_Close, 0x2D2D2D)
	EndIf

	If ($info[4] = $h_B_Minimize) Then
		If ($info[2] AND NOT $b_ClickMinimize) Then
			$b_ClickMinimize = True
			GUICtrlSetColor($h_B_Minimize, 0xFFFFFF)
			GUICtrlSetBkColor($h_B_Minimize, 0x888888)

			While ($info[4] = $h_B_Minimize AND $info[2])
				$info = GUIGetCursorInfo($h_GUI)
				Sleep(10)
			WEnd

			If (NOT $info[2]) Then
				GUISetState(@SW_MINIMIZE, $h_GUI)
			Else
				$b_HoverMinimize = False
				$b_ClickMinimize = False
				GUICtrlSetColor($h_B_Minimize, 0xD0D0D0)
				GUICtrlSetBkColor($h_B_Minimize, 0x2D2D2D)
			EndIf
		ElseIf (NOT $b_HoverMinimize) Then
			$b_HoverMinimize = True
			$b_ClickMinimize = False
			GUICtrlSetColor($h_B_Minimize, 0xFFFFFF)
			GUICtrlSetBkColor($h_B_Minimize, 0x666666)
		EndIf
	ElseIf ($b_HoverMinimize OR $b_ClickMinimize) Then
		$b_HoverMinimize = False
		$b_ClickMinimize = False
		GUICtrlSetColor($h_B_Minimize, 0xD0D0D0)
		GUICtrlSetBkColor($h_B_Minimize, 0x2D2D2D)
	EndIf

	If ($g_DllList_HoverHeader <> 0) Then
		_WinAPI_RedrawWindow($g_h_DllListHeader)
	EndIf

	$msg = GUIGetMsg($h_GUI)
	Switch $msg
		Case $GUI_EVENT_CLOSE
			Local $new_pos = WinGetPos($h_GUI)
			$g_MainGUI_X = $new_pos[0]
			$g_MainGUI_Y = $new_pos[1]
			Return $GUI_EXIT

		Case $GUI_EVENT_MINIMIZE
			GUISetState(@SW_MINIMIZE, $h_GUI)

	    Case $h_D_SelAll
			If (_WinAPI_GetFocus() = GUICtrlGetHandle($g_hDllList)) Then
				UpdateLV($g_hDllList, $A_ID_SelectAll)
			EndIf

	   	Case $h_B_SelProcess
			$l_ProcessListActive = True
			$newPID = CreateProcessList($h_GUI, $g_DarkThemeEnabled)
			$l_ProcessListActive = False

			If ($newPID <> -1) Then
				$g_PID = $newPID
				GUICtrlSetState($h_R_ProcName, $GUI_UNCHECKED)
				GUICtrlSetState($h_R_PID, $GUI_CHECKED)
				GUICtrlSetState($h_C_ProcName, $GUI_DISABLE)
				GUICtrlSetState($h_I_PID, $GUI_ENABLE)
				$g_ProcessByName = False
				UpdateTargetProcess()
			EndIf

		Case $h_B_Add
			AddFiles()

		Case $h_B_Remove
			UpdateLV($g_hDllList, $A_ID_Delete, $M_Selected)

		Case $GUI_EVENT_DROPPED
			If ($DropFileBuffer[0]) Then
				For $i = 1 To $DropFileBuffer[0]
					AddFile($DropFileBuffer[$i])
				Next
			EndIf

		Case $g_hDllList

			$State = GUICtrlGetState($g_hDllList)

			If ($State = 0) Then
				$count = _GUICtrlListView_GetItemCount($g_hDllList)
				For $i = 0 To $count - 1 Step 1
					$is_checked = _GUICtrlListView_GetItemChecked($g_hDllList, $i)
				    If ($is_checked) Then
				       _GUICtrlListView_SetItemText($g_hDllList, $i, 1, 4)
				    Else
				       _GUICtrlListView_SetItemText($g_hDllList, $i, 0, 4)
				    EndIf
				Next
				_GUICtrlListView_BeginUpdate($g_hDllList)
				_GUICtrlListView_SimpleSort($g_hDllList, $g_DllList_SortSense, 4, True)
				_GUICtrlListView_EndUpdate($g_hDllList)
			Else
				_GUICtrlListView_BeginUpdate($g_hDllList)
				_GUICtrlListView_SimpleSort($g_hDllList, $g_DllList_SortSense, $State, True)
				_GUICtrlListView_EndUpdate($g_hDllList)
			EndIf

		Case $h_B_Reset
			Return $GUI_RESET

		Case $h_B_SwitchTheme
			If ($g_DarkThemeEnabled) Then
				UpdateTheme(False)
			Else
				UpdateTheme(True)
			EndIf

		Case $h_R_ProcName
			If ((GUICtrlRead($h_R_ProcName) = $GUI_CHECKED) AND  (GUICtrlGetState($h_I_PID) <> $GUI_DISABLE)) Then
				GUICtrlSetState($h_I_PID, $GUI_DISABLE)
				GUICtrlSetState($h_C_ProcName, $GUI_ENABLE)
				$g_ProcessByName = True
				$g_Processname = GUICtrlRead($h_C_ProcName)
			EndIf

			$l_UpdateProcess = True

		Case $h_R_PID
			If ((GUICtrlRead($h_R_PID) = $GUI_CHECKED) AND  (GUICtrlGetState($h_C_ProcName) <> $GUI_DISABLE)) Then
				GUICtrlSetState($h_C_ProcName, $GUI_DISABLE)
				GUICtrlSetState($h_I_PID, $GUI_ENABLE)
				$g_ProcessByName = False
				$g_PID = GUICtrlRead($h_I_PID)
			EndIf

			$l_UpdateProcess = True

		Case $h_C_CloseAI
			If (GUICtrlRead($h_C_CloseAI) = $GUI_CHECKED) Then
				$g_CloseAfterInjection = True
			Else
				$g_CloseAfterInjection = False
			EndIf

		Case $h_C_AutoI
			If (GUICtrlRead($h_C_AutoI) = $GUI_CHECKED) Then
				$g_AutoInjection = True
			Else
				$g_AutoInjection = False
			EndIf

		Case $h_C_Method
			$g_InjectionMethod = _GUICtrlComboBox_GetCurSel($h_C_Method)

			If ($g_InjectionMethod = 0) Then
				If (GUICtrlGetState($h_C_Shift) <> $GUI_DISABLE) Then
					GUICtrlSetState($h_L_Unlink, $GUI_DISABLE)
					GUICtrlSetState($h_C_Unlink, $GUI_ENABLE)

					GUICtrlSetState($h_C_Shift, BitOR($GUI_DISABLE, $GUI_UNCHECKED))
					GUICtrlSetState($h_C_Clean, BitOR($GUI_DISABLE, $GUI_UNCHECKED))
					GUICtrlSetState($h_L_Shift, $GUI_ENABLE)
					GUICtrlSetState($h_L_Clean, $GUI_ENABLE)

					If (BitAND($g_InjectionFlags, $INJ_SHIFT_MODULE)) Then
						$g_InjectionFlags = BitXOR($g_InjectionFlags, $INJ_SHIFT_MODULE)
					EndIf
					If (BitAND($g_InjectionFlags, $INJ_CLEAN_DATA_DIR)) Then
						$g_InjectionFlags = BitXOR($g_InjectionFlags, $INJ_CLEAN_DATA_DIR)
					EndIf
				EndIf
			ElseIf ($g_InjectionMethod = 1) Then
				If (GUICtrlGetState($h_C_Shift) <> $GUI_DISABLE) Then
					GUICtrlSetState($h_L_Unlink, $GUI_DISABLE)
					GUICtrlSetState($h_C_Unlink, $GUI_ENABLE)

					GUICtrlSetState($h_C_Shift, BitOR($GUI_DISABLE, $GUI_UNCHECKED))
					GUICtrlSetState($h_C_Clean, BitOR($GUI_DISABLE, $GUI_UNCHECKED))
					GUICtrlSetState($h_L_Shift, $GUI_ENABLE)
					GUICtrlSetState($h_L_Clean, $GUI_ENABLE)

					If (BitAND($g_InjectionFlags, $INJ_SHIFT_MODULE)) Then
						$g_InjectionFlags = BitXOR($g_InjectionFlags, $INJ_SHIFT_MODULE)
					EndIf
					If (BitAND($g_InjectionFlags, $INJ_CLEAN_DATA_DIR)) Then
						$g_InjectionFlags = BitXOR($g_InjectionFlags, $INJ_CLEAN_DATA_DIR)
					EndIf
				EndIf
			ElseIf ($g_InjectionMethod = 2) Then
				If (GUICtrlGetState($h_C_Shift) <> $GUI_ENABLE) Then

					GUICtrlSetState($h_L_Shift, $GUI_DISABLE)
					GUICtrlSetState($h_L_Clean, $GUI_DISABLE)
					GUICtrlSetState($h_C_Shift, $GUI_ENABLE)
					GUICtrlSetState($h_C_Clean, $GUI_ENABLE)

					GUICtrlSetState($h_C_Unlink, BitOR($GUI_CHECKED, $GUI_DISABLE))
					GUICtrlSetState($h_L_Unlink, $GUI_ENABLE)

					$g_InjectionFlags = BitOR($g_InjectionFlags, $INJ_UNLINK_FROM_PEB)
				EndIf
			EndIf

		Case $h_C_HijackHandle
			If (GUICtrlRead($h_C_HijackHandle) = $GUI_CHECKED) Then
				If (NOT BitAND($g_InjectionFlags, $INJ_HIJACK_HANDLE)) Then
					$g_InjectionFlags = BitOR($g_InjectionFlags, $INJ_HIJACK_HANDLE)
				EndIf
			Else
				If (BitAND($g_InjectionFlags, $INJ_HIJACK_HANDLE)) Then
					$g_InjectionFlags = BitXOR($g_InjectionFlags, $INJ_HIJACK_HANDLE)
				EndIf
			EndIf

		Case $h_C_LaunchMethod
			$g_LaunchMethod = _GUICtrlComboBox_GetCurSel($h_C_LaunchMethod)
			If (($g_LaunchMethod) AND (BitAND(GUICtrlGetState($h_C_CloakThread), $GUI_ENABLE))) Then
				GUICtrlSetState($h_C_CloakThread, BitOR($GUI_UNCHECKED, $GUI_DISABLE))
				GUICtrlSetState($h_L_CloakThread, $GUI_ENABLE)
				If (BitAND($g_InjectionFlags, $INJ_THREAD_CREATE_CLOAKED)) Then
					$g_InjectionFlags = BitXOR($g_InjectionFlags, $INJ_THREAD_CREATE_CLOAKED)
				EndIf
			ElseIf (($g_LaunchMethod = 0) AND (BitAND(GUICtrlGetState($h_C_CloakThread), $GUI_DISABLE))) Then
				GUICtrlSetState($h_L_CloakThread, $GUI_DISABLE)
				GUICtrlSetState($h_C_CloakThread, $GUI_ENABLE)
			EndIf

		Case $h_C_CloakThread
			If (GUICtrlRead($h_C_CloakThread) = $GUI_CHECKED) Then
				$g_InjectionFlags = BitOR($g_InjectionFlags, $INJ_THREAD_CREATE_CLOAKED)
			ElseIf (BitAND($g_InjectionFlags, $INJ_THREAD_CREATE_CLOAKED)) Then
				$g_InjectionFlags = BitXOR($g_InjectionFlags, $INJ_THREAD_CREATE_CLOAKED)
			EndIf

		Case $h_C_Header
			$HeaderOption = _GUICtrlComboBox_GetCurSel($h_C_Header)
			If (BitAND($g_InjectionFlags, $INJ_ERASE_HEADER)) Then
				$g_InjectionFlags = BitXOR($g_InjectionFlags, $INJ_ERASE_HEADER)
			EndIf
			If (BitAND($g_InjectionFlags, $INJ_FAKE_HEADER)) Then
				$g_InjectionFlags = BitXOR($g_InjectionFlags, $INJ_FAKE_HEADER)
			EndIf

			If ($HeaderOption = 1) Then
				$g_InjectionFlags = BitOR($g_InjectionFlags, $INJ_ERASE_HEADER)
			ElseIf ($HeaderOption = 2) Then
				$g_InjectionFlags = BitOR($g_InjectionFlags, $INJ_FAKE_HEADER)
			EndIf

		Case $h_C_RandomizeName
			If (GUICtrlRead($h_C_RandomizeName) = $GUI_CHECKED) Then
				$g_InjectionFlags = BitOR($g_InjectionFlags, $INJ_SCRAMBLE_DLL_NAME)
			ElseIf (BitAND($g_InjectionFlags, $INJ_SCRAMBLE_DLL_NAME)) Then
					$g_InjectionFlags = BitXOR($g_InjectionFlags, $INJ_SCRAMBLE_DLL_NAME)
			EndIf

		Case $h_B_AdvSettings

			$pos = WinGetPos($h_GUI)
			WinMove($h_G_AdvSettings, "", $pos[0] + 15, $pos[1] + 285)
			GUISetState(@SW_SHOW, $h_G_AdvSettings)

			While (True)

				$Msg2 = GUIGetMsg($h_G_AdvSettings)

				If (_WinAPI_GetForegroundWindow() <> $h_G_AdvSettings) Then
					$Msg2 = $GUI_EVENT_CLOSE
				EndIf

				Switch $Msg2
					Case $h_C_Shift
						If (GUICtrlRead($h_C_Shift) = $GUI_CHECKED) Then
							$g_InjectionFlags = BitOR($g_InjectionFlags, $INJ_SHIFT_MODULE)
						Else
							If (BitAND($g_InjectionFlags, $INJ_SHIFT_MODULE)) Then
								$g_InjectionFlags = BitXOR($g_InjectionFlags, $INJ_SHIFT_MODULE)
							EndIf
						EndIf

					Case $h_C_Clean
						If (GUICtrlRead($h_C_Clean) = $GUI_CHECKED) Then
							$g_InjectionFlags = BitOR($g_InjectionFlags, $INJ_CLEAN_DATA_DIR)
						Else
							If (BitAND($g_InjectionFlags, $INJ_CLEAN_DATA_DIR)) Then
								$g_InjectionFlags = BitXOR($g_InjectionFlags, $INJ_CLEAN_DATA_DIR)
							EndIf
						EndIf

					Case $h_C_Unlink
						If (GUICtrlRead($h_C_Unlink) = $GUI_CHECKED) Then
							$g_InjectionFlags = BitOR($g_InjectionFlags, $INJ_UNLINK_FROM_PEB)
						Else
							If (BitAND($g_InjectionFlags, $INJ_UNLINK_FROM_PEB)) Then
								$g_InjectionFlags = BitXOR($g_InjectionFlags, $INJ_UNLINK_FROM_PEB)
							EndIf
						EndIf

					Case $GUI_EVENT_CLOSE
						GUISetState(@SW_HIDE, $h_G_AdvSettings)
						ExitLoop

				EndSwitch

				Sleep(10)

			WEnd

		Case $h_C_LoadCopy
			If (GUICtrlRead($h_C_LoadCopy) = $GUI_CHECKED) Then
				$g_InjectionFlags = BitOR($g_InjectionFlags, $INJ_LOAD_DLL_COPY)
			Else
				If (BitAND($g_InjectionFlags, $INJ_LOAD_DLL_COPY)) Then
					$g_InjectionFlags = BitXOR($g_InjectionFlags, $INJ_LOAD_DLL_COPY)
				EndIf
			EndIf

		Case $h_B_Inject
			Return $GUI_INJECT

		Case $h_L_Version
			If (BitAND(DllCall($h_User32_dll, "SHORT", "GetAsyncKeyState", "int", $VK_CONTROL)[0], 0x8000)) Then
				Return $GUI_FORCE_UPDATE
			Else
				Return $GUI_UPDATE
			EndIf

		Case $h_B_Help
			ShellExecute("https://www.guidedhacking.com/ghinjector")

		Case $h_B_Changelog
			ShellExecute("https://www.pastebin.com/eN7KPX3x")

		Case $h_B_ToggleTips
			If ($g_ToolTipsOn = True) Then
				GUICtrlSetData($h_B_ToggleTips, "Enable tooltips")
				_GUIToolTip_Deactivate($h_T_TooltipCtrl)
				$g_ToolTipsOn = False
			Else
				GUICtrlSetData($h_B_ToggleTips, "Disable tooltips")
				_GUIToolTip_Activate($h_T_TooltipCtrl)
				$g_ToolTipsOn = True
			EndIf

	EndSwitch

	Return $GUI_RETURN

EndFunc   ;==>UpdateGUI